!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("regenerator-runtime")):"function"==typeof define&&define.amd?define(["exports","regenerator-runtime"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).MindmapView={},e.regeneratorRuntime)}(this,(function(e,t){"use strict";function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var i=n(t);const o="function"==typeof crypto.randomUUID?crypto.randomUUID.bind(crypto):function(){return crypto.getRandomValues(new Uint8Array(10)).join("-")};function r(e,t,...n){if(e)return e;throw"function"==typeof t?t.apply(void 0,n):t}const a=Symbol("EBlockContainer.DomEventHandler"),s=Symbol("EBlockContainer.DomEventProc");class c{static DomEventDispatcher=s;constructor(){Object.defineProperty(this,a,{value:this[s].bind(this),writable:!1})}define(e){throw new Error("No implementation")}undefine(e){throw new Error("No implementation")}get stageContainer(){throw new Error("No implementation")}get eventContainer(){throw new Error("No implementation")}enableDomEvent(e){return this.eventContainer.addEventListener(e,this[a]),this}disableDomEvent(e){return this.eventContainer.removeEventListener(e,this[a]),this}addEventListener(...e){return this.eventContainer.addEventListener(...e),this}removeEventListener(...e){return this.eventContainer.addEventListener(...e),this}[s](e){throw new Error("No implementation")}}class l{static RegistryMap=new WeakMap;static AcquireRegistry(e){r(e instanceof c,Error,"The _container must be an instance of EBlockContainer");let t=l.RegistryMap.get(e);return t instanceof WeakSet||(t=new WeakSet,l.RegistryMap.set(e,t)),t}static peekPredefineds(e,t){const n=[...e.querySelectorAll("[eblock-predefined]")];return t||(t=""),n.forEach((e=>e.setAttribute("eblock-predefined",t))),n}static peekScripts(e){let t={};return[...e.querySelectorAll("[eblock-script]")].forEach((e=>{let n=new Function("declarer",`${e.textContent};return declarer;`);try{t=n(t)}catch(t){console.error("Exception raised when generating the script",e,t)}})),t}static peekTemplateNode(e){return e.querySelector("[eblock-template]")}constructor(e){r(e&&"function"==typeof e.querySelectorAll,Error,"The _node must be an instance can invoke querySelector");const t=o();Object.defineProperties(this,{id:{writable:!1,value:t},source:{writable:!1,value:e},predefineds:{writable:!1,value:l.peekPredefineds(e,t)},scripts:{writable:!1,value:l.peekScripts(e)},templateNode:{writable:!1,value:l.peekTemplateNode(e)}})}register(e){const t=l.AcquireRegistry(e);return t.has(this)||(this.predefineds.forEach((t=>e.define(t.cloneNode(!0)))),"function"==typeof this.onFactorRegister&&this.onFactorRegister(e),this.callScript("onFactorRegister",this,e),t.add(this)),this}unregister(e){const t=l.AcquireRegistry(e);return t.has(this)&&("function"==typeof this.onFactorUnregister&&this.onFactorUnregister(e),this.callScript("onFactorUnregister",this,e),e.undefine(`[eblock-predefined="${this.id}"]`),t.delete(this)),this}generate(e,t,n,...i){r("function"==typeof t&&t.prototype instanceof m,Error,"The _blockClass must be inherited from EBlock"),r(e instanceof Node,Error,"The _containerNode must be an instance of Node");let o=new t(this,n,...i);return e&&o.mount(e),o}generateFromTemplate(){return this.templateNode&&this.templateNode.cloneNode(!0)}queryNodeFromTemplate(e){return this.templateNode&&e&&this.templateNode.querySelector(e)}callScript(e,t,...n){return this.applyScript(e,t,n)}applyScript(e,t,n){const i=this.scripts[e];return"function"==typeof i&&i.apply(t,n)}}const u=Symbol("eblock.block.id"),p=Symbol("eblock.constructor.ref"),d=Symbol("eblock.factor.ref"),h=Symbol("eblock.data.ref"),f=new WeakMap;function v(){return this.source[this.key]}function g(e){this.source[this.key]=e}class m{static GetInstance(e){if(e instanceof Node)try{let t=f.get(e);return t&&new t[p](e,void 0)}catch{return null}}static equal(e,t){return e instanceof m?e.equal(t):void 0===e&&void 0===t}constructor(e,t,...n){let i,a,s=!1;e instanceof Node?(a=e,i=f.get(a),r(i,Error,"The node is not assigned with the avaliable metadata"),r(i[p]===this.constructor,Error,"The node is not matched the special class derived from EBlock")):(r(e instanceof l,Error,"_factorOrNode must be an instance of EBlockFactor or Node"),a=e.generateFromTemplate(),r(a instanceof Node,Error,"Cannot clone the node from the template"),i={[u]:o(),[p]:this.constructor,[d]:e,[h]:t,queuePromise:null},e.callScript("onInitMetadata",e,i,t,a,...n),this.initMetadata(i,t,a,...n),f.set(a,i),s=!0);const c=Object.getOwnPropertyDescriptors(i),m={$assignedNode:{value:a,writable:!1,configurable:!1,enumerable:!0},data:{value:i[h],writable:!1,configurable:!1,enumerable:!0},factor:{value:i[d],writable:!1,configurable:!1,enumerable:!0},blockID:{value:i[u],writable:!1,configurable:!1,enumerable:!0},$stubFlag:{value:!s,writable:!1,configurable:!1,enumerable:!0}};for(let e in c)if("symbol"!=typeof e){let t=c[e];if(t.get||t.set)m["$"+e]=t;else{let n={source:i,key:e};m["$"+e]={get:v.bind(n),set:t.writable?g.bind(n):void 0,configurable:!1,enumerable:t.enumerable}}}for(let e of Object.getOwnPropertySymbols(i))if(!(e in m)){let t={source:i,key:e};m[e]={get:v.bind(t),set:g.bind(t),configurable:!1,enumerable:!1}}Object.defineProperties(this,m),s&&this.queueAction((()=>this.fireEvent("ebevent-create",t)))}initMetadata(e,t,n,...i){}acquireNode(e,t,n){if(e){let i=this.$assignedNode.querySelector(e);return!i&&t?(i=this.factor.queryNodeFromTemplate(e),i&&(i=i.cloneNode(!0)),i&&t.insertAdjacentElement(n||"afterend",i)):t&&t.insertAdjacentElement(n||"afterend",i),i}}equal(e){return e instanceof m&&this.$assignedNode===e.$assignedNode}queueAction(e){return"function"==typeof e&&(this.$queuePromise instanceof Promise?this.$queuePromise=this.$queuePromise.then((()=>{try{return e()}catch(e){console.warn(`Exception raised in processing action in queue[#${this.blockID}]`,e)}})):this.$queuePromise=Promise.resolve(void 0).then((()=>{try{return e()}catch(e){console.warn(`Exception raised in processing action in queue[#${this.blockID}]`,e)}}))),this}fireEvent(e,...t){try{const n=this.factor;[...this.$assignedNode.querySelectorAll(`${this.eventSelectorPrefix||""}[${e}]`)].reverse().forEach((i=>{let o=i.getAttribute(e);o&&n.applyScript(o,this,[...t,i])}));let i=this.$assignedNode.getAttribute(e);i&&n.applyScript(i,this,[...t,this.$assignedNode]);let o=this[`on-${e}`];"function"==typeof o&&o.apply(this,t)}catch(t){console.warn(`Exception raised in fireEvent(${e})[#${this.blockID}]`,t)}return this}mount(e){return e instanceof Node?(this.fireEvent("ebevent-mounting",this.data),e.appendChild(this.$assignedNode),this.fireEvent("ebevent-mounted",this.data)):console.warn("The _containerNode must be an instance of Node"),this}unmount(){return this.fireEvent("ebevent-unmounting",this.data),this.$assignedNode.remove(),this.fireEvent("ebevent-unmounted",this.data)}render(...e){let t={};return this.fireEvent("ebevent-prepare-render",this.data,t,...e).fireEvent("ebevent-rendering",this.data,t,...e).fireEvent("ebevent-rendered",this.data,t,...e)}}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function w(e,t,n){return t&&b(e.prototype,t),n&&b(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function k(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function x(e,t){return x=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},x(e,t)}function E(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&x(e,t)}function A(e){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},A(e)}function L(e,t){if(t&&("object"===A(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return k(e)}function S(e){return S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},S(e)}function N(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function T(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,N(e,t,"get"))}function C(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,N(e,t,"set"),n),n}
/**
                           * @author season <season-studio@outlook.com>
                           * @license Apache-2.0
                           */function M(e,t,n){for(var i=arguments.length,o=new Array(i>3?i-3:0),r=3;r<i;r++)o[r-3]=arguments[r];if(this instanceof M){var a=Reflect.construct(Error,[t].concat(o));return a.code=e,a.detail=n,Object.setPrototypeOf(a,Object.getPrototypeOf(this)),Error.captureStackTrace&&Error.captureStackTrace(a,M),a}return Reflect.construct.apply(Reflect,[M].concat(Array.prototype.slice.call(arguments)))}function B(e,t,n,i,o,r,a){try{var s=e[r](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(i,o)}function D(e){return function(){var t=this,n=arguments;return new Promise((function(i,o){var r=e.apply(t,n);function a(e){B(r,i,o,a,s,"next",e)}function s(e){B(r,i,o,a,s,"throw",e)}a(void 0)}))}}function z(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function q(e,t,n){return q=z()?Reflect.construct:function(e,t,n){var i=[null];i.push.apply(i,t);var o=new(Function.bind.apply(e,i));return n&&x(o,n.prototype),o},q.apply(null,arguments)}function $(e){var t="function"==typeof Map?new Map:void 0;return $=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,i)}function i(){return q(e,arguments,S(this).constructor)}return i.prototype=Object.create(e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),x(i,e)},$(e)}function I(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}M.prototype=Object.create(Error.prototype,{constructor:{value:Error,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(M,Error):M.__proto__=Error;var R=i.default;function V(e,t){if(e)return e;throw"function"==typeof t?t.apply(void 0,[...arguments].slice(2)):t}function G(e,t){if(e&&t){Object.assign(e,t);for(let n in e){let i=e[n];i&&"object"==typeof i&&(e[n]=G(i instanceof Array?[]:{},t[n]))}}return e}function P(e,t,n,i){if(e&&t)if("object"==typeof t){const i=!(arguments.length>2)||n;for(let n in t)Object.defineProperty(e,n,{value:t[n],writable:!1,enumerable:i})}else Object.defineProperty(e,t,{value:n,writable:!1,enumerable:!(arguments.length>3)||i});return e}function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=S(e);if(t){var o=S(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return L(this,n)}}var j=function(e){E(n,e);var t=O(n);function n(e,i,o){return y(this,n),t.apply(this,arguments)}return w(n,[{key:"initMetadata",value:function(e,t,n,i){}},{key:"name",get:function(){return this.factor.$info.name}},{key:"topic",get:function(){var e=this.$assignedNode.parentNode;return e&&(e=e.parentNode),e&&(e=e.parentNode),e&&m.GetInstance(e)}},{key:"callScript",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return this.factor.applyScript(e,this,n)}},{key:"applyScript",value:function(e,t,n){return this.factor.applyScript(e,this,n)}}]),n}(m),H=function(e){E(n,e);var t=O(n);function n(e){var i;y(this,n);var o=(i=t.apply(this,arguments)).callScript("getExtensionInfo",k(i));return V(o&&o.name,M,-1,"The extension do not provide it's information and name by function 'getEntensionInfo'"),P(k(i),"$info",o),i}return w(n)}(l);function F(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=S(e);if(t){var o=S(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return L(this,n)}}function _(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}var W,U=new WeakMap,X=function(e){E(r,e);var t,n,i=F(r);function r(){var e;return y(this,r),_(k(e=i.call(this)),U,{writable:!0,value:[]}),I(k(e),"config",G({},r.DefaultConfig)),I(k(e),"dragable",!0),I(k(e),"editable",!0),I(k(e),"dragContext",void 0),e}return w(r,[{key:"extensionFactors",get:function(){return T(this,U)}},{key:"randomID",get:function(){return o()}},{key:"fireEvent",value:function(e,t){this.dispatchEvent(e instanceof Event?e:new CustomEvent(e,{detail:t}))}},{key:"translateHRefToURL",value:function(e){var t={source:e,destination:e};return this.fireEvent("topic-event-translate-href-url",t),t.destination}},{key:"getHRefType",value:function(e){var t={href:e,type:"link"};return this.fireEvent("topic-event-get-href-type",t),t.type}},{key:"getImageDataFromElement",value:function(e,t){try{t||(t={});var n=document.createElement("canvas"),i=Number(t.width)||Number(e.width),o=Number(t.height)||Number(e.height);V(i&&o,M,-1,"The width and height is invalid!"),n.width=i,n.height=o;var r=n.getContext("2d");return r.fillStyle=t.fill||"rgba(255,255,255,0)",r.fillRect(0,0,i,o),r.drawImage(e,Number(t.offsetX)||0,Number(t.offsetY)||0),t.toBlob?new Promise((function(e){return n.toBlob((function(t){e({width:i,height:o,data:t})}),"image/".concat(t.type||"png"))})):Promise.resolve({width:i,height:o,data:n.toDataURL("image/".concat(t.type||"png"))})}catch(e){this.warn("Fail in get image's data from an element",e)}}},{key:"getImageData",value:(n=D(R.mark((function e(t,n){var i;return R.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n||(n={}),(i=new Image).src=t,n.crossOrigin&&(i.crossOrigin=n.crossOrigin),e.next=7,i.decode();case 7:return e.next=9,this.getImageDataFromElement(i,n);case 9:return e.abrupt("return",e.sent);case 12:e.prev=12,e.t0=e.catch(0),this.warn("Fail in load image:",t,e.t0);case 15:case"end":return e.stop()}}),e,this,[[0,12]])}))),function(e,t){return n.apply(this,arguments)})},{key:"warn",value:function(){var e;(e=console).warn.apply(e,arguments)}},{key:"confirm",value:(t=D(R.mark((function e(t,n){return R.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(n||{}).default||0);case 1:case"end":return e.stop()}}),e)}))),function(e,n){return t.apply(this,arguments)})},{key:"activeLink",value:function(e){e&&window.open(e,"_blank")}}]),r}($(EventTarget));function Y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=S(e);if(t){var o=S(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return L(this,n)}}function K(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}I(X,"DefaultConfig",Object.freeze({padding:10,secondaryPadding:5,levelMargin:46,secondaryLevelMargin:26,siblingMargin:26,secondarySiblingMargin:17,secondaryTopicLevel:2,suitableTitleLineWidth:120,directionPriority:"right",dragStartFocusFilterTimer:50,dragStartNoFocusFilterTimer:100,resourceScheme:"xap",defaultResourceAttachmentPrefix:"resources/",placeholderImageID:"season-topic-predefine-image-picture-placeholder"}));var Q=Symbol("MindmapContainer.ResizeProc"),Z=Symbol("MindmapContainer.ResizeObserverHandler"),J=new WeakMap;W=c.DomEventDispatcher;var ee=function(e){E(n,e);var t=Y(n);function n(e,i){var r;y(this,n),V(e instanceof Node,M,-1,"_parentNode must be an instance of Node"),V(i instanceof X,M,-1,"_env must be an instance of MindmapEnvironment"),K(k(r=t.call(this)),J,{writable:!0,value:void 0}),e.innerHTML='\n<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" tabindex="0" overflow="hidden" width="640" height="480" viewBox="0 0 640 480" style="outline:none;">\n<style>\n    [season-mind-map-svg] {\n        --topic-ui-focus-color: #5cf;\n        --topic-ui-focus-border-color: #055cff;\n        --topic-ui-danger-color: #f22;\n        --topic-ui-emphasize-front-color: #fff;\n        --topic-ui-hover-back-color: #ccc;\n        \n        -webkit-touch-callout: none; /* iOS Safari */\n        -webkit-user-select: none; /* Chrome/Safari/Opera */\n        -khtml-user-select: none; /* Konqueror */\n        -moz-user-select: none; /* Firefox */\n        -ms-user-select: none; /* Internet Explorer/Edge */\n        user-select: none; /* Non-prefixed version, currently not supported by any browser */\n    }\n    \n    [season-mind-map-svg] *::-webkit-scrollbar {\n        width: 10px;\n        height: 10px;\n        background: transparent;\n        cursor: point;\n    }\n    [season-mind-map-svg] *::-webkit-scrollbar-corner {\n        background: transparent;\n    }\n    [season-mind-map-svg] *::-webkit-scrollbar-track {\n        background: transparent;\n        cursor: point;\n    }\n    [season-mind-map-svg] *::-webkit-scrollbar-thumb\n    {\n        -webkit-border-radius: 7px;\n        border-radius: 7px;\n        background: rgba(57,57,57,0.1);\n        cursor: point;\n    }\n    [season-mind-map-svg] *:hover::-webkit-scrollbar-thumb {\n        -webkit-border-radius: 7px;\n        border-radius: 7px;\n        background: rgba(0,0,0,0.1); \n        cursor: point;\n    }\n\n    .season-topic-svg-button > rect {\n        fill: rgba(255,255,255,0.05);\n        stroke: none;\n    }\n    .season-topic-svg-button[d-svg-button-has-border] > rect {\n        fill: rgba(255,255,255,0.05);\n        stroke: var(--topic-ui-hover-back-color);\n    }\n    .season-topic-svg-button > use, .season-topic-svg-button > path {\n        fill: #000;\n        stroke: none;\n    }\n    .season-topic-svg-button:hover > rect {\n        fill: var(--topic-ui-hover-back-color);\n    }\n    .season-topic-svg-button:hover > use, .season-topic-svg-button:hover > path {\n        fill: #000;\n    }\n    .season-topic-svg-button[d-svg-button-danger]:hover > rect {\n        fill: var(--topic-ui-danger-color);\n    }\n    .season-topic-svg-button[d-svg-button-danger]:hover > use, .season-topic-svg-button[d-svg-button-danger]:hover > path {\n        fill: var(--topic-ui-emphasize-front-color);\n    }\n\n    .season-topic-svg-3d-button > rect {\n        fill: url(#season-svg-3d-fill);\n        stroke-width: 0.5px;\n        stroke: #bbb;\n    }\n    .season-topic-svg-3d-button > use, .season-topic-svg-button > path {\n        fill: #000;\n        stroke: none;\n    }\n    .season-topic-svg-3d-button:hover > rect {\n        fill: url(#season-svg-3d-fill-hover);\n        stroke-width: 0.5px;\n        stroke: #bbb;\n    }\n    .season-topic-svg-3d-button:hover > use, .season-topic-svg-button:hover > path {\n        fill: #fff;\n        stroke: none;\n    }\n    .season-topic-svg-3d-button:active > rect {\n        fill: url(#season-svg-3d-fill-active);\n        stroke-width: 0.5px;\n        stroke: #bbb;\n    }\n    .season-topic-svg-3d-button:active > use, .season-topic-svg-button:active > path {\n        fill: #fff;\n        stroke: none;\n    }\n    .season-topic-svg-3d-button[d-svg-button-danger]:hover > rect {\n        fill: url(#season-svg-3d-danger-fill-hover);\n        stroke-width: 0.5px;\n        stroke: #bbb;\n    }\n    .season-topic-svg-3d-button[d-svg-button-danger]:hover > use, .season-topic-svg-button[d-svg-button-danger]:hover > path {\n        fill: #fff;\n        stroke: none;\n    }\n    .season-topic-svg-3d-button[d-svg-button-danger]:active > rect {\n        fill: url(#season-svg-3d-danger-fill-active);\n        stroke-width: 0.5px;\n        stroke: #bbb;\n    }\n    .season-topic-svg-3d-button[d-svg-button-danger]:active > use, .season-topic-svg-button[d-svg-button-danger]:active > path {\n        fill: #fff;\n        stroke: none;\n    }\n    \n</style>\n<defs season-topic-predefine-filter-and-pattern="">\n    <linearGradient id="season-svg-3d-fill" x1="0" y1="0" x2="0" y2="1">\n        <stop stop-color="#fff" stop-opacity="1" offset="0" />\n        <stop stop-color="#f0f0f0" stop-opacity="1" offset="0.3" />\n        <stop stop-color="#e0e0e0" stop-opacity="1" offset="0.9" />\n        <stop stop-color="#ccc" stop-opacity="1" offset="1" />\n    </linearGradient>\n    <linearGradient id="season-svg-3d-fill-hover" x1="0" y1="0" x2="0" y2="1">\n        <stop stop-color="#0af" stop-opacity="1" offset="0" />\n        <stop stop-color="#009dff" stop-opacity="1" offset="0.1" />\n        <stop stop-color="#07f" stop-opacity="1" offset="0.75" />\n        <stop stop-color="#06f" stop-opacity="1" offset="1" />\n    </linearGradient>\n    <linearGradient id="season-svg-3d-fill-active" x1="0" y1="0" x2="0" y2="1">\n        <stop stop-color="#06f" stop-opacity="1" offset="0" />\n        <stop stop-color="#07f" stop-opacity="1" offset="0.1" />\n        <stop stop-color="#009dff" stop-opacity="1" offset="0.75" />\n        <stop stop-color="#0af" stop-opacity="1" offset="1" />\n    </linearGradient>\n    <linearGradient id="season-svg-3d-danger-fill-hover" x1="0" y1="0" x2="0" y2="1">\n        <stop stop-color="#f55" stop-opacity="1" offset="0" />\n        <stop stop-color="#f33" stop-opacity="1" offset="0.1" />\n        <stop stop-color="#f00" stop-opacity="1" offset="0.75" />\n        <stop stop-color="#b00" stop-opacity="1" offset="1" />\n    </linearGradient>\n    <linearGradient id="season-svg-3d-danger-fill-active" x1="0" y1="0" x2="0" y2="1">\n        <stop stop-color="#c00" stop-opacity="1" offset="0" />\n        <stop stop-color="#f00" stop-opacity="1" offset="0.1" />\n        <stop stop-color="#f33" stop-opacity="1" offset="0.75" />\n        <stop stop-color="#f55" stop-opacity="1" offset="1" />\n    </linearGradient>\n</defs>\n<defs season-topic-predefine-image="">\n    <symbol id="season-topic-predefine-image-picture-placeholder" width="76" height="58" viewBox="0 0 76 58" preserveAspectRatio="none">\n        <path d="M 0 0 L 0 58 L 76 58 L 76 0 L 0 0 z M 17 9 C 18.7 9 20 10.3 20 12 C 20 13.7 18.7 15 17 15 C 15.3 15 14 13.7 14 12 C 14 10.3 15.3 9 17 9 z M 17 11 C 16.4 11 16 11.4 16 12 C 16 12.6 16.4 13 17 13 C 17.6 13 18 12.6 18 12 C 18 11.4 17.6 11 17 11 z M 30 11 C 30.3 11 30.7 11.2 30.8 11.4 L 45.8 34.2 L 52.1 22.5 C 52.3 22.2 52.6 22 53 22 C 53.4 22 53.7 22.2 53.9 22.5 L 67.9 46.5 C 68 46.7 68 46.8 68 47 C 68 47.6 67.6 48 67 48 L 8 48 C 7.8 48 7.6 47.9 7.4 47.9 C 6.9 47.6 6.8 47 7.1 46.5 L 17 30.7 C 17.1 30.6 17.2 30.4 17.3 30.3 L 29.2 11.5 C 29.3 11.2 29.7 11 30 11 z M 30 13.9 L 20.7 28.7 L 26.6 26.1 C 27 25.9 27.4 26 27.7 26.3 L 30 28.6 L 32.8 25.8 C 33.1 25.4 33.6 25.4 34 25.6 L 40.1 29.2 L 30 13.9 z M 53 25.1 L 47 36.1 L 53.5 46 L 65.3 46 L 53 25.1 z M 33.7 27.7 L 30.7 30.7 C 30.3 31.1 29.7 31.1 29.3 30.7 L 26.8 28.2 L 18.8 31.8 L 9.801 46 L 51.1 46 L 42.5 32.8 L 33.7 27.7 z" />\n    </symbol>\n    <symbol id="season-topic-predefine-image-bold" width="20" height="20" viewBox="0 0 20 20" preserveAspectRatio="none">\n        <path d="m 12.04,9.665 q 1.57,0.365 2.2,0.885 0.91,0.74 0.91,1.92 0,1.24 -1,2.05 -1.23,0.98 -3.57,0.98 H 5 v -0.3 q 0.762,0 1.03,-0.14 0.275,-0.14 0.381,-0.37 0.113,-0.23 0.113,-1.13 V 6.429 Q 6.524,5.537 6.411,5.311 6.305,5.075 6.03,4.938 5.755,4.8 5,4.8 V 4.5 h 5.27 q 1.9,0 2.68,0.34 0.78,0.333 1.24,1.005 0.45,0.665 0.45,1.42 0,0.795 -0.57,1.42 -0.57,0.616 -2.03,0.98 z M 9.087,9.446 q 1.153,0 1.693,-0.258 0.56,-0.261 0.85,-0.731 0.29,-0.471 0.29,-1.2 0,-0.73 -0.29,-1.192 Q 11.35,5.595 10.81,5.351 10.27,5.108 9.087,5.116 Z m 0,0.634 v 3.53 0.4 q 0,0.44 0.218,0.67 0.229,0.23 0.665,0.23 0.65,0 1.19,-0.29 0.56,-0.3 0.85,-0.84 0.29,-0.56 0.29,-1.22 0,-0.77 -0.36,-1.38 -0.37,-0.62 -0.99,-0.86 -0.62,-0.25 -1.862,-0.24 z" />\n    </symbol>\n    <symbol id="season-topic-predefine-image-italic" width="20" height="20" viewBox="0 0 20 20" preserveAspectRatio="none">\n        <path d="m 11.27,15.2 -0.1,0.3 H 6.65 l 0.113,-0.3 q 0.682,0 0.901,-0.11 0.357,-0.14 0.528,-0.39 0.266,-0.38 0.551,-1.35 L 10.66,6.706 Q 10.9,5.878 10.9,5.457 10.9,5.246 10.8,5.1 10.69,4.954 10.48,4.882 10.26,4.797 9.635,4.797 L 9.733,4.5 h 4.257 l -0.1,0.3 q -0.52,0 -0.77,0.114 -0.36,0.161 -0.56,0.462 -0.18,0.3 -0.49,1.33 l -1.9,6.644 q -0.259,0.91 -0.259,1.16 0,0.21 0.1,0.36 0.11,0.13 0.32,0.21 0.23,0.1 0.94,0.12 z" />        \n    </symbol>\n    <symbol id="season-topic-predefine-image-underline" width="20" height="20" viewBox="0 0 20 20" preserveAspectRatio="none">\n        <path d="m 5.4,4.5 v 0.244 c 0.379,0 0.639,0.03 0.779,0.106 0.141,0.07 0.241,0.176 0.298,0.305 0.06,0.122 0.09,0.441 0.09,0.957 V 10.5 c 0,0.74 0.119,1.33 0.356,1.77 0.239,0.44 0.646,0.81 1.223,1.09 0.423,0.21 1.022,0.31 1.798,0.31 0.926,0 1.666,-0.2 2.196,-0.59 0.53,-0.39 0.87,-0.82 1.01,-1.29 0.14,-0.46 0.21,-1.22 0.21,-2.274 V 6.112 c 0,-0.365 0,-0.618 0.1,-0.759 0.1,-0.203 0.2,-0.355 0.37,-0.456 0.16,-0.102 0.37,-0.153 0.62,-0.153 h 0.19 V 4.5 h -3.12 v 0.244 c 0.37,0 0.65,0.05 0.84,0.153 0.13,0.07 0.24,0.184 0.32,0.357 0.1,0.171 0.13,0.457 0.13,0.858 v 3.655 c 0,0.953 -0.1,1.613 -0.26,2.003 -0.16,0.38 -0.42,0.68 -0.76,0.9 -0.34,0.21 -0.76,0.32 -1.24,0.32 -0.42,0 -0.776,-0.1 -1.053,-0.25 C 9.219,12.56 9.019,12.35 8.895,12.09 8.777,11.82 8.717,11.3 8.717,10.5 V 6.112 c 0,-0.511 0.03,-0.83 0.08,-0.957 C 8.854,5.026 8.946,4.927 9.074,4.857 9.206,4.782 9.447,4.744 9.794,4.744 H 10.03 V 4.5 Z m 0,9.73 v 1.27 h 9.23 v -1.27 z" />    \n    </symbol>\n    <symbol id="season-topic-predefine-image-unorder-list" width="20" height="20" viewBox="0 0 20 20" preserveAspectRatio="none">\n        <path d="M 5 5 L 5 6.5 L 6.5 6.5 L 6.5 5 L 5 5 z M 7.5 5 L 7.5 6.5 L 15 6.5 L 15 5 L 7.5 5 z M 5 9.5 L 5 11 L 6.5 11 L 6.5 9.5 L 5 9.5 z M 7.5 9.5 L 7.5 11 L 15 11 L 15 9.5 L 7.5 9.5 z M 5 14 L 5 15.5 L 6.5 15.5 L 6.5 14 L 5 14 z M 7.5 14 L 7.5 15.5 L 15 15.5 L 15 14 L 7.5 14 z " />    \n    </symbol>\n    <symbol id="season-topic-predefine-image-order-list" width="20" height="20" viewBox="0 0 20 20" preserveAspectRatio="none">\n        <path d="M 6.125 5 L 4.5 5.742 L 4.559 5.859 C 4.717 5.79 4.852 5.756 4.963 5.756 C 5.032 5.756 5.093 5.774 5.145 5.811 C 5.199 5.845 5.237 5.889 5.256 5.941 C 5.276 5.991 5.285 6.116 5.285 6.32 L 5.285 8.609 C 5.285 8.887 5.27 9.065 5.242 9.141 C 5.214 9.217 5.16 9.273 5.08 9.312 C 4.999 9.359 4.864 9.383 4.676 9.383 L 4.559 9.383 L 4.559 9.504 L 6.887 9.504 L 6.887 9.383 L 6.785 9.383 C 6.618 9.383 6.498 9.359 6.422 9.312 C 6.349 9.265 6.298 9.204 6.271 9.131 C 6.245 9.055 6.232 8.881 6.232 8.609 L 6.232 5 L 6.125 5 z M 7.5 5 L 7.5 6.5 L 15 6.5 L 15 5 L 7.5 5 z M 8.314 9.5 L 8.314 11 L 15 11 L 15 9.5 L 8.314 9.5 z M 5.939 11 C 5.627 11 5.35 11.1 5.111 11.3 C 4.873 11.5 4.695 11.81 4.578 12.24 L 4.697 12.24 C 4.882 11.91 5.143 11.74 5.477 11.74 C 5.681 11.74 5.853 11.82 5.994 11.97 C 6.135 12.12 6.205 12.3 6.205 12.53 C 6.205 12.84 6.119 13.16 5.947 13.49 C 5.778 13.82 5.296 14.46 4.5 15.41 L 4.5 15.51 L 7.098 15.51 L 7.346 14.26 L 7.229 14.26 C 7.156 14.39 7.095 14.49 7.049 14.56 C 7.003 14.63 6.944 14.66 6.873 14.66 L 6.418 14.66 L 5.463 14.66 C 6.201 13.94 6.679 13.38 6.898 12.98 C 7.059 12.68 7.141 12.39 7.141 12.1 C 7.141 11.94 7.087 11.77 6.982 11.59 C 6.878 11.41 6.735 11.27 6.551 11.16 C 6.366 11.05 6.163 11 5.939 11 z M 8.314 14 L 8.314 15.5 L 15 15.5 L 15 14 L 8.314 14 z " />\n    </symbol>\n    <symbol id="season-topic-predefine-image-open" width="96" height="96" viewBox="0 0 96 96" preserveAspectRatio="none">\n        <path d="m 11.94,75.97 c 0,0 0.1,0 0.11,0 H 74 L 87.6,46.8 C 88.57,44.77 87.71,42.34 85.69,41.37 85.28,41.18 84.85,41.05 84.4,41 H 80 v -9 c 0,-2.2 -1.79,-3.99 -4,-4 H 46.28 c -0.18,0 -0.36,0 -0.51,-0.15 L 35,20.7 C 34.34,20.27 33.58,20.03 32.8,20 H 14 c -2.21,0 -3.99,1.79 -4,4 v 49.98 c 0,1.08 0.86,1.96 1.94,1.99 z M 84.29,43 c 1.13,0.2 1.88,1.28 1.68,2.4 0,0.18 -0.1,0.35 -0.16,0.51 v 0 0 L 72.75,73.94 v 0 H 14.1 c 0,0 0,0 0,0 0,0 0,0 0,0 L 26.43,44.01 C 26.72,43.4 27.33,43.01 28,43 Z M 12,24 c 0,-1.11 0.9,-2 2,-2 h 18.8 c 0.41,0 0.81,0.17 1.15,0.4 l 10.71,7.11 C 45.14,29.83 45.7,30 46.28,30 H 76 c 1.1,0 2,0.89 2,2 v 8.99 H 29 c -0.1,0 -0.1,0 -0.16,0 H 28 c -1.47,0 -2.79,0.87 -3.4,2.2 L 12.02,73.76 z" />\n    </symbol>\n    <symbol id="season-topic-predefine-image-nodepad" width="96" height="96" viewBox="0 0 96 96" preserveAspectRatio="none">\n        <rect width="60" height="80" x="18" y="8" />\n        <path d="M 28,35 h 20 0 M 28,25 h 17 v 0 M 28,45 h 40 v 0 M 28,55 h 40 v 0 M 28,65 h 40 v 0 M 28,75 h 40 v 0" />\n        <circle cx="60" cy="25" r="8" />\n    </symbol>\n    <symbol id="season-topic-predefine-image-picture" width="96" height="96" viewBox="0 0 96 96" preserveAspectRatio="none">\n        <path d="M 10 19 L 10 77 L 86 77 L 86 19 L 10 19 z M 12 21 L 84 21 L 84 75 L 12 75 L 12 21 z M 27 28 C 25.3 28 24 29.3 24 31 C 24 32.7 25.3 34 27 34 C 28.7 34 30 32.7 30 31 C 30 29.3 28.7 28 27 28 z M 27 30 C 27.6 30 28 30.4 28 31 C 28 31.6 27.6 32 27 32 C 26.4 32 26 31.6 26 31 C 26 30.4 26.4 30 27 30 z M 40 30 C 39.7 30 39.3 30.2 39.2 30.5 L 27.3 49.3 C 27.2 49.4 27.1 49.6 27 49.7 L 17.1 65.5 C 16.8 66 16.9 66.6 17.4 66.9 C 17.6 66.9 17.8 67 18 67 L 77 67 C 77.6 67 78 66.6 78 66 C 78 65.8 78 65.7 77.9 65.5 L 63.9 41.5 C 63.7 41.2 63.4 41 63 41 C 62.6 41 62.3 41.2 62.1 41.5 L 55.8 53.2 L 40.8 30.4 C 40.7 30.2 40.3 30 40 30 z M 40 32.9 L 50.1 48.2 L 44 44.6 C 43.6 44.4 43.1 44.4 42.8 44.8 L 40 47.6 L 37.7 45.3 C 37.4 45 37 44.9 36.6 45.1 L 30.7 47.7 L 40 32.9 z M 63 44.1 L 75.3 65 L 63.5 65 L 57 55.1 L 63 44.1 z M 43.7 46.7 L 52.5 51.8 L 61.1 65 L 19.8 65 L 28.8 50.8 L 36.8 47.2 L 39.3 49.7 C 39.7 50.1 40.3 50.1 40.7 49.7 L 43.7 46.7 z" />\n    </symbol>\n    <symbol id="season-topic-predefine-image-pencil" width="96" height="96" viewBox="0 0 96 96" preserveAspectRatio="none">\n        <path d="m 86.82,16.2 -7.03,-7 c -1.56,-1.6 -4.1,-1.6 -5.66,0 0,0 0,0 0,0 L 14.03,69.3 8,88.1 26.75,82 v 0 L 86.82,21.9 c 1.56,-1.6 1.56,-4.1 0,-5.7 z m -19.76,2.9 9.88,9.9 -2.14,2.1 -9.88,-9.9 z m -41.44,61.2 -11.13,3.6 -2.3,-2.3 3.57,-11.2 c 2.03,-1.6 5.58,-0.9 8.17,1.7 2.58,2.6 3.28,6.1 1.69,8.2 z m -0.28,-9.6 c -1.79,-1.9 -4.22,-3 -6.8,-3.1 l 44.97,-45 9.88,9.9 -44.95,45 c -0.13,-2.6 -1.24,-5 -3.1,-6.8 z m 60.06,-50.2 -7.05,7 -9.88,-9.8 7.07,-7.1 c 0.78,-0.8 2.05,-0.8 2.83,0 0,0 0,0 0,0 l 7.03,7.1 c 0.78,0.7 0.78,2 0,2.8 z" />\n    </symbol>\n    <symbol id="season-topic-predefine-image-delete" width="96" height="96" viewBox="0 0 96 96" preserveAspectRatio="none">\n        <path d="M 42 10 C 39.24 10 37 12.2 37 15 L 37 18 L 19 18 C 16.79 18 15.01 19.8 15 22 L 15 28 L 81 28 L 81 22 C 81 19.8 79.21 18 77 18 L 59 18 L 59 15 C 59 12.2 56.76 10 54 10 L 42 10 z M 42 12 L 54 12 C 55.66 12 57 13.3 57 15 L 57 18 L 39 18 L 39 15 C 39 13.3 40.34 12 42 12 z M 19 20 L 77 20 C 78.11 20 79 20.9 79 22 L 79 26 L 17 26 L 17 22 C 17 20.9 17.89 20 19 20 z M 20.5 31 C 19.67 31 19 31.67 19 32.5 C 19 32.59 19.01 32.68 19.03 32.77 C 19.01 32.86 19 32.95 19 33.04 L 19 80.04 C 19 80.12 19.01 80.19 19.02 80.27 C 19.01 80.35 19 80.42 19 80.5 C 19 81.33 19.67 82 20.5 82 L 75.5 82 C 76.33 82 77 81.33 77 80.5 C 77 80.42 76.99 80.35 76.98 80.27 C 76.99 80.19 77 80.12 77 80.04 L 77 33.04 C 77 32.95 76.99 32.86 76.97 32.77 C 76.99 32.68 77 32.59 77 32.5 C 77 31.67 76.33 31 75.5 31 L 20.5 31 z M 22 34 L 74 34 L 74 79 L 22 79 L 22 34 z M 34 38 C 33.17 38 32.5 38.59 32.5 39.32 L 32.5 73.68 C 32.5 74.41 33.17 75 34 75 C 34.83 75 35.5 74.41 35.5 73.68 L 35.5 39.32 C 35.5 38.59 34.83 38 34 38 z M 48 38 C 47.17 38 46.5 38.59 46.5 39.32 L 46.5 73.68 C 46.5 74.41 47.17 75 48 75 C 48.83 75 49.5 74.41 49.5 73.68 L 49.5 39.32 C 49.5 38.59 48.83 38 48 38 z M 62 38 C 61.17 38 60.5 38.59 60.5 39.32 L 60.5 73.68 C 60.5 74.41 61.17 75 62 75 C 62.83 75 63.5 74.41 63.5 73.68 L 63.5 39.32 C 63.5 38.59 62.83 38 62 38 z" />\n    </symbol>\n    <symbol id="season-topic-predefine-image-eraser" width="96" height="96" viewBox="0 0 96 96" preserveAspectRatio="none">\n        <path d="M 84.09,39.93 58.63,14.43 c -1.95,-1.9 -5.12,-1.9 -7.07,0 l -39.6,39.6 c -1.95,2 -1.95,5.1 0,7.1 l 22.22,22.19 h 43.85 v -2 h -28.3 l 34.36,-34.4 c 1.95,-1.9 1.95,-5.1 0,-6.99 z M 35.03,81.32 H 35 L 13.38,59.72 c -1.17,-1.19 -1.17,-3.09 0,-4.3 0,0 0,0 0,0 l 19.09,-19.1 29.7,29.7 -15.27,15.3 z M 82.67,45.53 63.58,64.62 33.88,34.93 52.98,15.82 c 1.17,-1.1 3.07,-1.1 4.24,0 l 25.45,25.5 c 1.17,1.2 1.17,3.1 0,4.21 z" />\n    </symbol>\n    <symbol id="season-topic-predefine-image-cross" width="96" height="96" viewBox="0 0 96 96" preserveAspectRatio="none">\n        <path d="M 83,21.4 74.6,13 48,39.6 21.4,13 13,21.4 39.6,48 13,74.6 21.4,83 48,56.4 74.6,83 83,74.6 56.4,48 Z" />\n    </symbol>\n</defs>\n<defs season-topic-image-storage="">\n</defs>\n<g season-topic-root-node=""></g>\n</svg>\n';var a=e.querySelector("svg");a.setAttribute("season-mind-map-svg",o()),a.$scale=1,e.style.overflow="hidden";var s=e.style.position;return"relative"!==s&&"absolute"!==s&&(e.style.position="relative"),P(k(r),{env:i,svgElement:a,stageContainer:a.querySelector("g[season-topic-root-node]"),eventContainer:a}),C(k(r),J,new ResizeObserver(r[Z].bind(k(r)))).observe(e),r[Q]({width:e.clientWidth,height:e.clientHeight}),r}return w(n,[{key:"define",value:function(e){this.svgElement.insertBefore(e,this.stageContainer)}},{key:"undefine",value:function(e){this.svgElement.querySelectorAll(e).forEach((function(e){return e.remove()}))}},{key:Q,value:function(e){var t=this.svgElement,n=Number(t.$scale);n>0||(n=1);var i=t.viewBox.baseVal;t.setAttribute("width",e.width),t.setAttribute("height",e.height),t.setAttribute("viewBox","".concat(i.x," ").concat(i.y," ").concat(e.width/n," ").concat(e.height/n))}},{key:"scale",get:function(){return Number(this.svgElement.$scale)||1}},{key:"scale",set:function(e){(e=Number(e))>0||(e=1);var t=this.svgElement;t.$scale=e;var n=t.viewBox.baseVal,i=Number(t.width.baseVal.value),o=Number(t.height.baseVal.value);t.setAttribute("viewBox","".concat(n.x," ").concat(n.y," ").concat(i/e," ").concat(o/e)),this.env.fireEvent("topic-event-view-resize")}},{key:"move",value:function(e,t){var n=this.svgElement,i=n.viewBox.baseVal,o=i.x+(Number(e)||0),r=i.y+(Number(t)||0),a=r+i.height,s=o+i.width,c=this.stageContainer.getBBox(),l=c.x,u=c.y,p=c.width;u+c.height<r||u>a||l>s||l+p<o||n.setAttribute("viewBox","".concat(o," ").concat(r," ").concat(i.width," ").concat(i.height))}},{key:Z,value:function(e){var t=this,n=this.svgElement.parentNode;e.forEach((function(e){e.target===n&&t[Q](e.contentRect)})),this.env.fireEvent("topic-event-view-resize")}},{key:"createDomEvent",value:function(e,t){return new CustomEvent("topic-domevent-".concat(e),{detail:t})}},{key:"addEventListener",value:function(){var e;return(e=this.env).addEventListener.apply(e,arguments),this}},{key:"removeEventListener",value:function(){var e;return(e=this.env).addEventListener.apply(e,arguments),this}},{key:"dispose",value:function(){T(this,J)&&T(this,J).disconnect(),this.svgElement.remove()}},{key:W,value:function(e){var t=this;try{var n=e.target;if(n)if("mousedown"===e.type)n.$mousedownTimeStamp=e.timeStamp,n.$mouseEventX=e.offsetX,n.$mouseEventY=e.offsetY;else if("click"===e.type){var i=e.timeStamp-(Number(n.$mousedownTimeStamp)||0),o=Math.abs(e.offsetX-(Number(n.$mouseEventX)||Number.MAX_VALUE)),r=Math.abs(e.offsetY-(Number(n.$mouseEventY)||Number.MAX_VALUE));if(n.$mousedownTimeStamp=0,n.$mouseEventX=Number.MAX_VALUE,n.$mouseEventY=Number.MAX_VALUE,i>1e3&&(o>10||r>10))return}var a=this.eventContainer,s=void 0;e.path.forEach((function(n){void 0===s&&n.hasAttribute("season-topic-content-type")&&(s=n.getAttribute("season-topic-content-type"));var i=m.GetInstance(n);if(i&&i.handleDomEvent||n===a){var o="topic-domevent-".concat(e.type),r={eventName:o,triggerContentType:s,eventTarget:i,originEvent:e,preventDefault:!1,stopPropagation:!1};throw i&&i.fireEvent(o,r),t.env.fireEvent(t.createDomEvent(e.type,r)),r.preventDefault&&e.preventDefault(),r.stopPropagation&&e.stopPropagation(),null}}))}catch(t){null!==t&&this.env.warn("Exception raised when dispatch dom event",e,t)}}}]),n}(c);function te(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function ne(e){return function(e){if(Array.isArray(e))return te(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return te(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?te(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ie(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return oe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return oe(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,r=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw r}}}}function oe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function re(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=S(e);if(t){var o=S(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return L(this,n)}}function ae(e,t){ce(e,t),t.add(e)}function se(e,t,n){ce(e,t),t.set(e,n)}function ce(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function le(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}var ue="season-topic-focus",pe=Symbol("topic.children.group.node"),de=Symbol("topic.level"),he=Symbol("topic.direction"),fe=Symbol("topic.fold"),ve=new WeakMap,ge=new WeakSet,me=new WeakSet,ye=new WeakSet,be=new WeakSet,we=new WeakSet,ke=new WeakSet,xe=new WeakSet,Ee=new WeakSet,Ae=new WeakSet,Le=new WeakSet,Se=new WeakSet,Ne=function(e){E(n,e);var t=re(n);function n(e,i,o,r){var a;y(this,n),ae(k(a=t.apply(this,arguments)),Se),ae(k(a),Le),ae(k(a),Ae),ae(k(a),Ee),ae(k(a),xe),ae(k(a),ke),ae(k(a),we),ae(k(a),be),ae(k(a),ye),ae(k(a),me),ae(k(a),ge),se(k(a),ve,{writable:!0,value:void 0}),P(k(a),{env:a.$env,handleDomEvent:!0,eventSelectorPrefix:":scope > [season-topic-content-group] > "});var s=C(k(a),ve,a.$assignedNode.querySelector(":scope > [season-topic-content-group]"));if(!a.$stubFlag){s.setAttribute("season-topic-content-group",a.id);var c=a[pe];if(c&&(c.innerHTML="",c.setAttribute("season-topic-children-group",a.id),i.children instanceof Array)){var l=a[de]+1;i.children.forEach((function(t){e.generate(c,n,t,l,r)})),delete i.children}}return a}return w(n,[{key:"initMetadata",value:function(e,t,n,i,r){V(r instanceof X,M,-1,"_env must be an instance of MindmapEnvironment"),P(e,"env",r),e[pe]=n.querySelector(":scope > [season-topic-children-group]"),e[de]=Number(i)||0,e[he]=void 0,e[fe]=!1;var a=t.id,s=null==a;s&&(a=o());try{Object.defineProperty(t,"id",{value:a,writable:!1,configurable:!1,enumerable:!0})}catch(e){if(s)throw e}}},{key:"id",get:function(){return this.data.id}},{key:"level",get:function(){return this[de]}},{key:"direction",get:function(){return this[he]}},{key:"parentTopic",get:function(){var e=this.$assignedNode.parentNode,t=e&&e.parentNode;return t&&t.hasAttribute("season-topic-global")?n.GetInstance(t):void 0}},{key:"hasChildren",get:function(){var e=le(this,me,Ce).call(this);return e&&e.length>0}},{key:"rootTopic",get:function(){return n.getFirstChildTopic(le(this,ge,Te).call(this))}},{key:"firstChildTopic",get:function(){return n.getFirstChildTopic(this)}},{key:"getChildrenTopics",value:function(){return ne(le(this,me,Ce).call(this)).map((function(e){return n.GetInstance(e)}))}},{key:"enumerateChilrenTopics",value:R.mark((function e(){var t,i,o,r;return R.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=le(this,me,Ce).call(this),i=t&&t.length,o=0;case 3:if(!(o<i)){e.next=11;break}if(!((r=n.GetInstance(t[o]))instanceof n)){e.next=8;break}return e.next=8,r;case 8:o++,e.next=3;break;case 11:case"end":return e.stop()}}),e,this)}))},{key:"enumerateDescendantTopics",value:R.mark((function e(){var t,i,o,r;return R.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=le(this,me,Ce).call(this),i=t&&t.length,o=0;case 3:if(!(o<i)){e.next=12;break}if(!((r=n.GetInstance(t[o]))instanceof n)){e.next=9;break}return e.next=8,r;case 8:return e.delegateYield(r.enumerateDescendantTopics(),"t0",9);case 9:o++,e.next=3;break;case 12:case"end":return e.stop()}}),e,this)}))},{key:"enumerateTopics",value:R.mark((function e(){return R.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this;case 2:return e.delegateYield(this.enumerateDescendantTopics(),"t0",3);case 3:case"end":return e.stop()}}),e,this)}))},{key:"nextSiblingTopic",get:function(){for(var e=this.$assignedNode.nextSibling;e;e=e.nextSibling){var t=n.GetInstance(e);if(t instanceof n)return t}return null}},{key:"previousSiblingTopic",get:function(){for(var e=this.$assignedNode.previousSibling;e;e=e.previousSibling){var t=n.GetInstance(e);if(t instanceof n)return t}return null}},{key:"getTopicByID",value:function(e){return String(this.id)===String(e)?this:n.getTopicByID(this.$assignedNode,e)}},{key:"topicNode",get:function(){return this.$assignedNode}},{key:"exportTopicData",value:function(){var e,t=G({},this.data),n=[],i=ie(this.enumerateChilrenTopics());try{for(i.s();!(e=i.n()).done;){var o=e.value;n.push(o.exportTopicData())}}catch(e){i.e(e)}finally{i.f()}return n.length>0&&(t.children=n),t}},{key:"collectImageStorage",value:function(){try{var e=this.$assignedNode.ownerSVGElement.querySelector("[season-topic-image-storage]"),t=le(this,ge,Te).call(this);if(e&&t){var n=e.querySelectorAll(":scope > *");n&&n.forEach((function(e){var n=e.getAttribute("id");n&&t.querySelector('use[href="#'.concat(n,'"]'))||e.remove()}))}}catch(e){this.env.warn("Fail in collecting the images in the storage",e)}}},{key:"enumerateImageInStorage",value:R.mark((function e(){var t,n,i,o,r,a;return R.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(t=this.$assignedNode.ownerSVGElement.querySelector("[season-topic-image-storage]"))){e.next=22;break}n=ne(t.querySelectorAll(":scope > *")),i=ie(n),e.prev=5,i.s();case 7:if((o=i.n()).done){e.next=14;break}return r=o.value,a=r.querySelector(":scope > image"),e.next=12,{id:r.getAttribute("id"),href:a&&a.getAttribute("href"),width:r.$width||Number(r.getAttribute("width"))||0,height:r.$height||Number(r.getAttribute("height"))||0,sourceHRef:r.getAttribute("d-href")};case 12:e.next=7;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(5),i.e(e.t0);case 19:return e.prev=19,i.f(),e.finish(19);case 22:e.next=27;break;case 24:e.prev=24,e.t1=e.catch(0),this.env.warn("Fail in enumerating the images in the storage",e.t1);case 27:case"end":return e.stop()}}),e,this,[[0,24],[5,16,19,22]])}))},{key:"showInCenterOfView",value:function(){var e=T(this,ve).getBBox(),t=e.width,n=e.height,i=T(this,ve).getCTM(),o=i.e/i.a,r=i.f/i.d,a=T(this,ve).ownerSVGElement,s=a.viewBox.baseVal||{x:0,y:0,width:0,height:0},c=s.x,l=s.y,u=s.width,p=s.height;return u<=0&&(u=a.width.baseVal.value),p<=0&&(p=a.height.baseVal.value),o=parseInt(o+t/2),r=parseInt(r+n/2),c-=parseInt(u/2)-o,l-=parseInt(p/2)-r,a.setAttribute("viewBox","".concat(c," ").concat(l," ").concat(u," ").concat(p)),this.notify("topic-event-view-move"),this}},{key:"showInView",value:function(){return n.showNodeInSvgView(T(this,ve),this.$assignedNode.ownerSVGElement),this.notify("topic-event-view-move"),this}},{key:"notify",value:function(e,t){return"object"===A(t)?t.eventTarget=this:t={eventTarget:this},this.fireEvent(e,t),this.env.fireEvent(e,t),this}},{key:"on-ebevent-rendering",value:function(e,t,i,o){var r=this,a=this[de],s=this.env.config;this.$assignedNode.setAttribute("season-topic-global",e.id),a>0&&(this[he]=o);var c=T(this,ve);c.setAttribute("d-topic-id",e.id),c.setAttribute("d-topic-level",a);var l=c.querySelector(".season-topic-title");l&&((l.textContent=e.title)||(l.innerHTML="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"));var u=l.getBBox(),p=u.width,d=u.height,h=c.querySelector("[season-topic-extends]");le(this,Le,Ve).call(this,h,s,e,this,i,o);var f,v,g=h.getBBox(),m=g.width,y=g.height,b=0,w=0,k=e.image&&this.env.translateHRefToURL(e.image.href);k?(v=this.acquireNode(":scope > [season-topic-content-group] > .season-topic-image",T(this,ve),"beforeend"),b=Number(e.image.width)||p||Number(s.suitableTitleLineWidth)||X.DefaultConfig.suitableTitleLineWidth,(w=Number(e.image.height)||0)||(w=b/4*3),v?(v.setAttribute("width",b),v.setAttribute("height",w),le(this,Ae,Ie).call(this,k,v,b,w,s),f=2*s.padding+w):f=s.padding):((v=this.acquireNode(":scope > [season-topic-content-group] > .season-topic-image"))&&v.remove(),v=void 0,f=s.padding);var x,E,A=p+(m>0?s.padding+m:0),L=Number(s.suitableTitleLineWidth)||X.DefaultConfig.suitableTitleLineWidth;A>b&&(p>L||m>L)&&m>p?(x=Math.max(p,b,m),l.setAttribute("transform","translate(".concat(p>=x?s.padding:s.padding+(x-p)/2,", ").concat(f,")")),h.setAttribute("transform","translate(".concat(m>=x?s.padding:s.padding+(x-m)/2,", ").concat(f+=s.padding+d,")")),f+=y):(A<b?(E=s.padding+(b-A)/2,x=b):(E=s.padding,x=A),l.setAttribute("transform","translate(".concat(E,", ").concat(f,")")),h.setAttribute("transform","translate(".concat(E+s.padding+p,", ").concat(f,")")),f+=Math.max(d,y));v&&v.setAttribute("transform","translate(".concat(b>=x?s.padding:s.padding+(x-b)/2,", ").concat(s.padding,")"));var S=c.querySelector(".season-topic-box"),N=t.contentWidth=2*s.padding+x,C=t.contentHeight=s.padding+f;S&&(S.setAttribute("width",N),S.setAttribute("height",C));var M,B=t.childrenNodes=le(this,me,Ce).call(this);if(a>0&&B&&B.length>0){M=!(i>a||(isNaN(i)||i<=0)&&!this[fe]),this[fe]=M;var D=this.acquireNode(':scope > [season-topic-content-group] > [season-topic-content-type="fold"]',T(this,ve),"beforeend");if(D){D.setAttribute("href",M?"#topic-fold-icon-plus":"#topic-fold-icon-minus"),c.insertAdjacentElement("beforeend",D);var z=D.getBBox(),q=z.width,$=z.height;D.setAttribute("transform","translate(".concat(o?N-q/2:0-q/2,", ").concat((C-$)/2,")"))}}else{M=this[fe]=!1;var I=this.acquireNode(':scope > [season-topic-content-group] > [season-topic-content-type="fold"]');I&&I.remove()}var R=this[pe];if(M)R&&R.remove();else try{R&&R.isConnected||this.$assignedNode.insertAdjacentElement("afterbegin",R);var V=t.dirIndexThresold=parseInt((B.length+1)/2),G=t.rightPriority="left"!==String(this.env.config.directionPriority).toLowerCase();B.forEach((function(e,t){var a=n.GetInstance(e);a&&le(a,Se,Ge).call(a,i,r[de]<=0?G^t>=V:o)}))}catch(e){console.error("Exception raised in rendering children",e)}}},{key:"on-ebevent-rendered",value:function(e,t,i,o){var r=t.childrenNodes,a=this[pe];if(r&&r.length>0&&a){var s,c,l=this.env.config;this.level+1>=l.secondaryTopicLevel?(s=l.secondarySiblingMargin,c=l.secondaryLevelMargin):(s=l.siblingMargin,c=l.levelMargin);var u=t.contentWidth,p=t.contentHeight;if(this[de]<1){var d={itemList:[],config:l,siblingMargin:s,levelMargin:c,contentWidth:u,listHeight:0},h={itemList:[],config:l,siblingMargin:s,levelMargin:c,contentWidth:u,listHeight:0},f=t.dirIndexThresold,v=t.rightPriority;r.forEach((function(e,t){var i=n.GetInstance(e);i&&(v^t>=f?le(i,ye,Me).call(i,h):le(i,be,Be).call(i,d))})),d.listHeight-=s,h.listHeight-=s,le(this,we,De).call(this,d,h),le(this,ke,ze).call(this,h),le(this,ke,ze).call(this,d);var g=(h.listHeight>=d.listHeight?h.listHeight:d.listHeight)/2;le(this,xe,qe).call(this,h,a,g),le(this,xe,qe).call(this,d,a,g)}else if(!this[fe]){var m={itemList:[],config:l,siblingMargin:s,levelMargin:c,contentWidth:u,listHeight:0};o?t.childrenNodes.forEach((function(e){var t=n.GetInstance(e);t&&le(t,ye,Me).call(t,m)})):t.childrenNodes.forEach((function(e){var t=n.GetInstance(e);t&&le(t,be,Be).call(t,m)})),m.listHeight-=s,le(this,ke,ze).call(this,m);var y=m.listHeight/2;le(this,xe,qe).call(this,m,a,y)}var b=a.getBBox(),w=b.y,k=b.height;a.setAttribute("transform","translate(0, ".concat((p-(k+w))/2,")"))}}},{key:"render",value:function(){var e;return this.env.fireEvent("topic-event-before-render"),le(e=this[de]<1?this:this.rootTopic,Se,Ge).apply(e,arguments),this.env.fireEvent("topic-event-after-render"),this}},{key:"getFocus",value:function(){return n.getFocusTopic(le(this,ge,Te).call(this))}},{key:"killFocus",value:function(){return(this.$assignedNode.hasAttribute(ue)||T(this,ve).hasAttribute(ue))&&(this.notify("topic-event-cancel-edit"),this.notify("topic-event-kill-focus"),this.$assignedNode.removeAttribute(ue),T(this,ve).removeAttribute(ue)),this}},{key:"setFocus",value:function(e){var t=this.getFocus();return this.equal(t)?!e&&this:(t instanceof n&&t.killFocus(),this.$assignedNode.setAttribute(ue,"true"),T(this,ve).setAttribute(ue,"true"),this.notify("topic-event-set-focus"),!!e||this)}},{key:"hasFocus",get:function(){return this.$assignedNode.hasAttribute(ue)}},{key:"createChild",value:function(e,t){var i=this.factor.generate(this[pe],n,e,this[de]+1,this.env);return i&&t instanceof n&&this.equal(t.parentTopic)&&(t.$assignedNode.insertAdjacentElement("beforebegin",i.$assignedNode),i.notify("topic-event-change",{action:"create"})),i}},{key:"changeData",value:function(e,t){if(e){var n=G({},this.data);void 0===t?delete this.data[e]:this.data[e]=t,this.notify("topic-event-change",{action:"changeData",key:e,originValue:n})}return this}},{key:"moveTo",value:function(e,t){if(e instanceof n){var i=this.parentTopic,o=this.nextSiblingTopic;if(!n.equal(i,e)){var r=this.$assignedNode.parentNode,a=r&&r.querySelector('path[d-topic-id="'.concat(this.id,'"]'));a&&a.remove()}t&&n.equal(t.parentTopic,e)?t.$assignedNode.insertAdjacentElement("beforebegin",this.$assignedNode):e[pe]&&e[pe].insertAdjacentElement("beforeend",this.$assignedNode),le(this,Ee,$e).call(this,e[de]+1),this.notify("topic-event-change",{action:"move",originParent:i,originSibling:o})}else this.env.warn("No effect if the _parentTopic is not an instance of Topic");return this}},{key:"drop",value:function(e){var t;if(this.level>0||"function"==typeof e&&e(t=parseInt(100*Math.random()))===t+1){this.level>0&&this.notify("topic-event-change",{action:"drop"});var n,i=ie(this.enumerateDescendantTopics());try{for(i.s();!(n=i.n()).done;){var o=n.value;o[pe]=void 0,o.unmount()}}catch(e){i.e(e)}finally{i.f()}var r=this.parentTopic;if(r){var a=r[pe].querySelector('path[d-topic-id="'.concat(this.id,'"]'));a&&a.remove()}this[pe]=void 0,this.unmount()}}},{key:"getRect",value:function(e){var t=e?T(this,ve).querySelector(e):T(this,ve).querySelector(".season-topic-box")||T(this,ve);return t&&t.getBoundingClientRect()||new DOMRect}},{key:"getBBox",value:function(e){var t=e?T(this,ve).querySelector(e):T(this,ve).querySelector(".season-topic-box")||T(this,ve);return t instanceof SVGGraphicsElement&&t.getBBox()||{x:0,y:0,width:0,height:0}}},{key:"getGraphicRect",value:function(e){var t=e?T(this,ve).querySelector(e):T(this,ve).querySelector(".season-topic-box")||T(this,ve);if(t instanceof SVGGraphicsElement){var n=t.getCTM(),i=t.getBBox(),o=T(this,ve).ownerSVGElement.getCTM().inverse().translate(n.e,n.f),r=o.e,a=o.f,s=n.translate(i.width,i.height),c=s.e,l=s.f;return{x:r,y:a,width:c-=n.e,height:l-=n.f}}return{x:0,y:0,width:0,height:0}}},{key:"getMatrix",value:function(e){var t=e?T(this,ve).querySelector(e):T(this,ve).querySelector(".season-topic-box")||T(this,ve);return t instanceof SVGGraphicsElement&&t.getCTM()||new DOMMatrix([1,0,0,1,0,0])}},{key:"getRectInViewport",value:function(e){var t=e?T(this,ve).querySelector(e):T(this,ve).querySelector(".season-topic-box")||T(this,ve);if(t instanceof SVGGraphicsElement){var n=t.getCTM(),i=t.getBBox(),o=n.translate(i.x,i.y),r=n.translate(i.x+i.width,i.y+i.height);return{x:o.e,y:o.f,width:r.e-o.e,height:r.f-o.f}}return{x:0,y:0,width:0,height:0}}},{key:"getGlobalRect",value:function(){var e=le(this,ge,Te).call(this);return e?e.getBBox():{x:0,y:0,width:0,height:0}}},{key:"visible",get:function(){return"none"!=this.$assignedNode.style.display},set:function(e){var t=e?"":"none";this.$assignedNode.style.display=t;var n=this.$assignedNode.parentNode.querySelector('path[d-topic-id="'.concat(this.id,'"]'));n&&(n.style.display=t)}},{key:"getExtensionInstance",value:function(e){if(e){var t=void 0;try{var n=T(this,ve).querySelector("[season-topic-extends]"),i=n&&n.querySelectorAll(":scope > *");i&&i.forEach((function(n){var i=j.GetInstance(n);if(i&&i.name===e)throw t=i,null}))}catch(t){t&&this.env.warn("Fail in get extension instance of",e,t)}return t}}},{key:"on-topic-domevent-click",value:function(e){if(e.preventDefault=!0,this.setFocus(!0))e.triggerContentType=void 0,this.notify("topic-event-trigger",e);else{var t=e.triggerContentType;"fold"===t?(this[fe]=!this[fe],this.render()):(e.extensionInstance=this.getExtensionInstance(t),this.notify("topic-event-trigger",e))}}},{key:"on-topic-domevent-dblclick",value:function(e){e.preventDefault=!0,this.env.editable&&(this.showInView(),this.notify("topic-event-edit",e))}},{key:"on-topic-domevent-mousedown",value:function(e){if(1===e.originEvent.buttons&&!this.env.dragContext&&this.env.editable&&this.env.dragable&&this[de]>0){var t={sourceTopic:this,parentTopic:this.parentTopic,draging:!1,timeStamp:Date.now()};this.env.dragContext=t}}},{key:"on-topic-domevent-mousemove",value:function(e){var t=this.env.dragContext;if(t&&!t.draging){var n=this.env.config,i=Date.now()-t.timeStamp;(this.hasFocus&&i>=n.dragStartFocusFilterTimer||i>=n.dragStartNoFocusFilterTimer)&&(this.equal(t.sourceTopic)?(this.notify("topic-event-cancel-edit"),e.preventDefault=!0,t.draging=!0,this.factor.prepareDragTipElements(this,t),this.visible=!1):this.factor.clearDragContext(this.env))}}},{key:"on-topic-domevent-mouseover",value:function(e){var t=this,n=this.env.dragContext;n&&n.draging&&!this.equal(n.parentTopic)&&(this.factor.clearDragoverTimer(n),n.dragoverTopic=this,n.dragoverTimer=setTimeout((function(){n.parentTopic=n.dragoverTopic,t.factor.updateDragTipElements(n),t.factor.clearDragoverTimer(n)}),1e3))}},{key:"on-topic-domevent-mouseout",value:function(e){var t=this.env.dragContext;t&&this.equal(t.dragoverTopic)&&this.factor.clearDragoverTimer(t)}}],[{key:"getFirstChildTopic",value:function(e){var t=void 0;if(e instanceof Node)t=e.querySelector(":scope > g[season-topic-global]");else if(e instanceof n){var i=e[pe];i&&i.isConnected&&(t=i.querySelector(":scope > g[season-topic-global]"))}return n.GetInstance(t)}},{key:"getMindRootNode",value:function(e){return e instanceof SVGSVGElement?e.querySelector("g[season-topic-root-node]"):e instanceof SVGElement?e.ownerSVGElement.querySelector("g[season-topic-root-node]"):void 0}},{key:"getTopicByID",value:function(e,t){return n.GetInstance(e instanceof Node&&e.querySelector('g[season-topic-global="'.concat(t,'"]')))}},{key:"getFocusTopic",value:function(e){try{if(e instanceof Node){var t=e.querySelector("g[eblock-template][".concat(ue,"]"));return n.GetInstance(t)}}catch(e){return null}}},{key:"convertWindowPointToGraphic",value:function(e,t,n){e instanceof SVGSVGElement||(e=e instanceof SVGGraphicsElement&&e.ownerSVGElement);var i=e&&e.getCTM();return i?{x:(i=new DOMMatrix([i.a,i.b,i.c,i.d,0,0]).inverse().translate(t,n)).e,y:i.f}:{x:t,y:n}}},{key:"showNodeInSvgView",value:function(e,t){var i,o,r=e.getBoundingClientRect(),a=t.getBoundingClientRect();o=r.top<a.top?a.top-r.top:r.bottom>a.bottom?Math.max(a.bottom-r.bottom,a.top-r.top):0,i=r.left<a.left?a.left-r.left:r.right>a.right?Math.max(a.right-r.right,a.left-r.left):0;var s=t.viewBox.baseVal||{x:0,y:0,width:0,height:0},c=s.x,l=s.y,u=s.width,p=s.height;u<=0&&(u=t.width.baseVal.value),p<=0&&(p=t.height.baseVal.value);var d=n.convertWindowPointToGraphic(t,i,o);t.setAttribute("viewBox","".concat(c-d.x," ").concat(l-d.y," ").concat(u," ").concat(p))}}]),n}(m);function Te(){return Ne.getMindRootNode(this.$assignedNode)}function Ce(){return this[pe]&&this[pe].querySelectorAll(":scope > g[season-topic-global]")}function Me(e){var t=this.$assignedNode,n=t.getBBox(),i=n.y,o=n.height,r={startX:e.contentWidth,endX:e.contentWidth+e.levelMargin,endY:e.listHeight,id:this.data.id,itemOffsetY:i,itemHeight:o,itemNode:t};e.listHeight+=o+e.siblingMargin,e.itemList.push(r)}function Be(e){var t=this.$assignedNode,n=t.getBBox(),i=n.y,o=n.height,r=T(this,ve).getBBox(),a=r.x,s=r.width,c={startX:0,endX:0-e.levelMargin,endY:e.listHeight,id:this.data.id,itemOffsetY:i,itemHeight:o,itemContentWidth:s+a,itemNode:t};e.listHeight+=o+e.siblingMargin,e.itemList.push(c)}function De(e,t){if(e.listHeight>t.listHeight){var n=(e.listHeight-t.listHeight)/2;t.itemList.forEach((function(e){e.endY+=n}))}else if(t.listHeight>e.listHeight){var i=(t.listHeight-e.listHeight)/2;e.itemList.forEach((function(e){e.endY+=i}))}}function ze(e){e.itemList.forEach((function(e){e.itemNode.setAttribute("transform","translate(".concat(e.itemContentWidth?e.endX-e.itemContentWidth:e.endX,", ").concat(e.endY-e.itemOffsetY,")")),e.endY+=e.itemHeight/2}))}function qe(e,t,n){e.itemList.forEach((function(e){var i=t.querySelector('path[d-topic-id="'.concat(e.id,'"]'));i||(i=document.createElementNS("http://www.w3.org/2000/svg","path"),t.appendChild(i),i.setAttribute("d-topic-id",e.id)),i.setAttribute("class","season-topic-connect-line");var o=(e.endX-e.startX)/2+e.startX;i.setAttribute("d","M".concat(e.startX," ").concat(n,"C").concat(o," ").concat(n," ").concat(o," ").concat(e.endY," ").concat(e.endX," ").concat(e.endY))}))}function $e(e){this[de]=e;var t=le(this,me,Ce).call(this),n=e+1;t&&t.forEach((function(e){var t=e&&Ne.GetInstance(e);t instanceof Ne&&le(t,Ee,$e).call(t,n)}))}function Ie(e,t,n,i,o){return Re.apply(this,arguments)}function Re(){return(Re=D(R.mark((function e(t,n,i,r,a){var s,c,l,u,p,d;return R.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(s=this.$assignedNode.ownerSVGElement.querySelector("[season-topic-image-storage]"))){e.next=25;break}if(!(c=s.querySelector('symbol[d-url="'.concat(t,'"]')))){e.next=8;break}n.setAttribute("href","#"+c.getAttribute("id")),e.next=23;break;case 8:return l="storeimg-"+o(),(c=document.createElementNS("http://www.w3.org/2000/svg","symbol")).setAttribute("id",l),c.setAttribute("d-url",t),c.setAttribute("preserveAspectRatio","none"),c.setAttribute("width",i),c.setAttribute("height",r),c.setAttribute("viewBox","0 0 ".concat(i," ").concat(r)),c.insertAdjacentHTML("afterbegin",'<use href="#'.concat(a.placeholderImageID||X.DefaultConfig.placeholderImageID,'" width="').concat(i,'" height="').concat(r,'" style="mix-blend-mode:difference;fill:#000;" stroke="none" />')),s.appendChild(c),n.setAttribute("href","#"+l),e.next=21,this.env.getImageData(t,{type:"png"});case 21:(u=e.sent)?(p=u.width,d=u.height,c.setAttribute("width",c.$width=p),c.setAttribute("height",c.$height=d),c.setAttribute("viewBox","0 0 ".concat(p," ").concat(d)),c.innerHTML='<image class="season-topic-image" x="0" y="0" width="'.concat(p,'" height="').concat(d,'" href="').concat(u.data,'" />')):this.env.warn("Fail in loading image",t);case 23:e.next=26;break;case 25:throw"Fail in locating the storage node for images";case 26:e.next=31;break;case 28:e.prev=28,e.t0=e.catch(0),this.env.warn("Exception in loadImageInStorage:",t,e.t0);case 31:case"end":return e.stop()}}),e,this,[[0,28]])})))).apply(this,arguments)}function Ve(e,t,n){for(var i=this,o=arguments.length,r=new Array(o>3?o-3:0),a=3;a<o;a++)r[a-3]=arguments[a];if(e&&n){var s={},c=e.querySelectorAll(":scope > *");c&&c.forEach((function(e){var t=j.GetInstance(e);t&&t.name&&(s[t.name]=t)})),c=[],this.env.extensionFactors.forEach((function(t){var o,a=t.$info&&t.$info.name;a in s?o=s[a]:a in n&&(o=t.generate(e,j,n,i)),o&&(o.render.apply(o,r),o.$assignedNode.isConnected&&c.push(o.$assignedNode))}));var l=0;c.forEach((function(e){var t=e.getBBox();e.$width=t.width;var n=e.$height=t.height;l<n&&(l=n)}));var u=Number(t.secondaryPadding)||0,p=0;c.forEach((function(e){e.setAttribute("transform","translate(".concat(p,", ").concat((l-e.$height)/2,")")),p+=e.$width+u}))}}function Ge(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return m.prototype.render.apply(this,t),this}function Pe(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Oe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Oe(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,r=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw r}}}}function Oe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function je(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}var He=new WeakMap,Fe=new WeakMap,_e=new WeakMap,We=function(){function e(t){y(this,e),je(this,He,{writable:!0,value:void 0}),je(this,Fe,{writable:!0,value:void 0}),je(this,_e,{writable:!0,value:void 0}),V(t instanceof X,M,-1,"_env must be an instance of MindmapEnvironment"),P(this,"env",t),C(this,He,{}),C(this,Fe,[]),C(this,_e,{});var n,i=Pe(Object.getOwnPropertyNames(this.constructor.prototype));try{for(i.s();!(n=i.n()).done;){var o=n.value;if(o.startsWith("@")){var r=this[o];"function"==typeof r&&(o=o.substring(1),r=T(this,_e)[o]=r.bind(this),t.addEventListener(o,r))}}}catch(e){i.e(e)}finally{i.f()}}return w(e,[{key:"sheetCount",get:function(){return T(this,Fe).length}},{key:"firstSheet",get:function(){return T(this,Fe)[_index]}},{key:"getSheetByID",value:function(e){var t;try{T(this,Fe).forEach((function(n){e===n.id&&(t=n)}))}catch(e){e&&console.warn(e)}return t}},{key:"switchToSheet",value:function(e,t){var n=this.getSheetByID(e);return n?(t&&this.synchronizeWithView(),this.env.fireEvent("topic-event-view-switch-sheet",{sheet:n})):this.env.warn("sheet[".concat(e,"] no found")),this}},{key:"enumerateSheet",value:R.mark((function e(){var t;return R.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=R.keys(T(this,Fe));case 1:if((e.t1=e.t0()).done){e.next=7;break}return t=e.t1.value,e.next=5,{index:t,sheet:T(this,Fe)[t]};case 5:e.next=1;break;case 7:case"end":return e.stop()}}),e,this)}))},{key:"removeSheet",value:function(e,t){var n,i;for(i in t&&this.synchronizeWithView(),T(this,Fe))if(T(this,Fe)[i].id===e){n=T(this,Fe).splice(i,1),i>0&&(i-=1);break}var o=T(this,Fe)[i];return o||(o=G({},this.constructor.DefaultSheetTemplate),this.addSheet(o)),this.env.fireEvent("topic-event-view-switch-sheet",{sheet:o}),n}},{key:"addSheet",value:function(e,t){return e&&(e.id||(e.id=o()),V(!this.getSheetByID(e.id),M,-1,"The id of the sheet had been contained in the document"),isNaN(t)?T(this,Fe).push(e):T(this,Fe).splice(t,0,e),this.env.fireEvent("topic-event-sheet-list-changed")),this}},{key:"synchronizeWithView",value:function(){var e={sheets:[],attachments:{}};this.env.fireEvent("topic-event-view-submit",e);var t,n=Pe(e.sheets);try{for(n.s();!(t=n.n()).done;){var i=t.value,o=i.sheetID,r=i.topicData,a=this.getSheetByID(o);a?a.topic=r:this.addSheet({topic:r})}}catch(e){n.e(e)}finally{n.f()}for(var s in e.attachments)this.hasAttachment(s)||this.setAttachment(s,e.attachments[s]);return this}},{key:"enumerateAttachment",value:R.mark((function e(){var t;return R.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=R.keys(T(this,He));case 1:if((e.t1=e.t0()).done){e.next=7;break}return t=e.t1.value,e.next=5,{name:t,data:T(this,He)[t]};case 5:e.next=1;break;case 7:case"end":return e.stop()}}),e,this)}))},{key:"removeAttachment",value:function(e){var t=T(this,He)[e];return t instanceof Blob&&t.$url&&URL.revokeObjectURL(t.$url),delete T(this,He)[e],this}},{key:"getAttachment",value:function(e){return T(this,He)[e]}},{key:"setAttachment",value:function(e,t){return this.removeAttachment(e),T(this,He)[e]=t,this}},{key:"clearAttachment",value:function(){for(var e in T(this,He)){var t=T(this,He)[e];t instanceof Blob&&t.$url&&URL.revokeObjectURL(t.$url)}return C(this,He,{}),this}},{key:"hasAttachment",value:function(e){return e in T(this,He)}},{key:"newDocument",value:function(e){this.clearAttachment(),C(this,Fe,[]);for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return"function"==typeof e&&e.apply(this,n),T(this,Fe).length<=0&&C(this,Fe,[G({id:o()},this.constructor.DefaultSheetTemplate)]),this.env.fireEvent("topic-event-sheet-list-changed"),this.env.fireEvent("topic-event-view-switch-sheet",{sheet:T(this,Fe)[0]}),this}},{key:"saveDocument",value:function(){return this.env.fireEvent("topic-event-cancel-edit"),this.synchronizeSheetWithView(),this}},{key:"getThumbImage",value:function(e){this.env.fireEvent("topic-event-cancel-edit");var t={image:void 0,option:{toBlob:e||!1}};return this.env.fireEvent("topic-event-view-export-image",t),t.image instanceof Promise?t.image:Promise.resolve(t.image)}},{key:"@topic-event-translate-href-url",value:function(e){var t=e.detail;if(t){var n=String(t.source);if(n.startsWith("".concat(this.env.config.resourceScheme,":"))){n=n.substring(4);var i=T(this,He)[n];i instanceof Blob?t.destination=i.$url||(i.$url=URL.createObjectURL(i)):i&&(t.destination=String(i))}}}},{key:"@topic-event-get-href-type",value:function(e){var t=e.detail;t&&String(t.href).startsWith("".concat(this.env.config.resourceScheme,":"))&&(t.type="resource")}},{key:"@topic-event-update-attachment",value:function(e){var t=e.detail;if(t&&t.resource){var n=t.name||o();this.setAttachment(n,t.resource),t.href=this.env.config.resourceScheme+":"+n}}}]),e}();function Ue(e){var t=new WeakMap;return P(e,{binding:function(n){if(t.has(n))return t.get(n);var i=e.bind(n);return t.set(n,i),i},deleteBinding:function(e){return t.delete(e)}})}I(We,"DefaultSheetTemplate",{title:"New Sheet",topic:{title:"Main Topic"}}),I(We,"DefaultTopicTemplate",{title:"New Topic"});var Xe=["top","left","right","bottom"];function Ye(e,t,n,i){var o=(e-=2*t)/2;i+i>e&&(i=o);var r=o+n-i;r<0&&(r=0);var a=e-r-2*i;return a<0&&(a=0,r=e-2*i),[r,a]}function Ke(e){var t=e.target;if(t instanceof SVGGraphicsElement){t instanceof SVGSVGElement||(t=t.ownerSVGElement);var n=t.getCTM().inverse(),i=t.getBoundingClientRect(),o=n.translate(e.clientX-i.x,e.clientY-i.y);return{x:o.e,y:o.f}}return{x:0,y:0}}function Qe(e){e&&(e.dragStubNode&&e.dragStubNode.remove(),e.dragStubNode=void 0,e.dragLine&&e.dragLine.remove(),e.dragLine=void 0)}function Ze(e,t){if(e){var n=e.dragStubNode,i=0,o=0;if(n){var r=t instanceof MouseEvent?Ke(t):{x:n.$x,y:n.$y},a=r.x,s=r.y;n.setAttribute("transform","translate(".concat(a+2,", ").concat(s+2,")")),i=a+1+n.$width/2,o=s+1+n.$height/2,n.$x=a,n.$y=s}var c=e.dragLine;if(c&&e.parentTopic){var l=e.parentTopic.getGraphicRect();c.setAttribute("d","M".concat(l.x+l.width/2," ").concat(l.y+l.height/2,"L").concat(i," ").concat(o))}}}function Je(e){e&&(e.dragoverTimer&&clearTimeout(e.dragoverTimer),e.dragoverTimer=void 0,e.dragoverTopic=void 0)}function et(e){if(e){var t=e.dragContext;t&&(Je(t),Qe(t),t.sourceTopic&&(t.sourceTopic.visible=!0),t.sourceTopic=void 0,e.dragContext=void 0)}}var tt=Ue((function(e){var t=e.detail.originEvent,n=this.env.dragContext;0!=(1&t.buttons)?n&&n.draging&&n.sourceTopic&&Ze(n,t):n&&et(this.env)})),nt=Ue((function(e){var t=e.detail,n=t.originEvent;if(0==(1&n.buttons)){var i=this.env.dragContext;if(i){if(i.draging){t.preventDefault=!0;var o,r=Ke(n),a=i.parentTopic,s=i.sourceTopic;if(a.level>0)for(o=a.firstChildTopic;o;o=o.nextSiblingTopic){var c=o.getGraphicRect();if(!o.equal(s)&&c.y>=r.y)break}else{var l=a.getGraphicRect(),u=l.x+l.width/2,p=r.x>=u,d=!1;for(o=a.firstChildTopic;o;o=o.nextSiblingTopic){var h=o.getGraphicRect();if(p===h.x>=u){if(d=!0,!o.equal(s)&&h.y>=r.y)break}else if(d)break}}m.equal(a,s.parentTopic)&&m.equal(o,s.nextSiblingTopic)||s.moveTo(a,o),s.queueAction((function(){s.render(),s.$assignedNode.ownerSVGElement.focus()}))}et(this.env)}}})),it=Ue((function(e){var t=e.detail,n=t.originEvent;"escape"===String(n.key).toLowerCase()&&(et(this.env),t.preventDefault=!0)})),ot=new l((new DOMParser).parseFromString('\n<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n    <defs eblock-predefined="">\n        <path id="topic-fold-icon-plus" fill="#fff" fill-opacity="0.8" stroke="#000" stroke-width="1" transform="translate(-3, -1), scale(1.5, 1.5)" d="M1 4A3 3 0 1 0 8 4A3 3 0 1 0 1 4M2.5 4L6.5 4M4.5 2L4.5 6" />\n        <path id="topic-fold-icon-minus" fill="#fff" fill-opacity="0.8" stroke="#000" stroke-width="1" transform="translate(-3, -1), scale(1.5, 1.5)" d="M1 4A3 3 0 1 0 8 4A3 3 0 1 0 1 4M2.5 4L6.5 4" />\n        <pattern id="season-topic-drag-mask" x="0" y="0" width="4" height="4" patternUnits="userSpaceOnUse">\n            <rect x="2" y="0" width="2" height="2" fill="#000" stroke="none"></rect>\n            <rect x="0" y="2" width="2" height="2" fill="#000" stroke="none"></rect>\n        </pattern>\n    </defs>\n    <style eblock-predefined="">\n    <![CDATA[\n            \n        .season-topic-drag-group {\n            opacity: 0.7;\n        }\n\n        .season-topic-drag-mask {\n            rx: 6px;\n            ry: 6px;\n            fill: url(#season-topic-drag-mask);\n            fill-opacity: 0.3;\n            stroke: none;\n        }\n\n        .season-topic-drag-line {\n            fill: none;\n            stroke: #2c3e50;\n            stroke-width: 3px;\n            stroke-dasharray: 5, 5;\n            stroke-opacity: 0.6;\n        }\n\n        [season-topic-global] * {\n            outline: none;\n        }\n\n        [season-topic-content-group] {\n            font-size: 13px;\n        }\n\n        [season-topic-content-group][d-topic-level="0"] {\n            font-size: 17px;\n        }\n\n        .season-topic-box {\n            rx: 6px;\n            ry: 6px;\n            fill: #eee;\n            fill-opacity: 0.3;\n            stroke: #438ac9;\n            stroke-opacity: 0.3;\n            stroke-dasharray: 3,1;\n            stroke-width: 0.5px;\n        }\n\n        .season-topic-title {\n            alignment-baseline: before-edge;\n            dominant-baseline: text-before-edge;\n            fill: #000;\n        }\n\n        .season-topic-connect-line {\n            fill: none;\n            stroke: #1a2530;\n            stroke-width: 2px;\n        }\n\n        .season-topic-image {\n            \n        }\n\n        [d-topic-level="0"] > .season-topic-box {\n            rx: 6px;\n            ry: 6px;\n            fill: #438ac9;\n            fill-opacity: 0.9;\n            stroke: #4472c4;\n            stroke-opacity: 0.6;\n            stroke-width: 1.5px;\n            stroke-dasharray: none;\n        }\n\n        [d-topic-level="0"] > .season-topic-title {\n            fill: #fff;\n            font-weight: 700;\n        }\n\n        [d-topic-level="1"] > .season-topic-box {\n            rx: 6px;\n            ry: 6px;\n            fill: #438ac9;\n            fill-opacity: 0.3;\n            stroke: #438ac9;\n            stroke-opacity: 0.6;\n            stroke-width: 1px;\n            stroke-dasharray: none;\n        }\n\n        [d-topic-level="1"] > .season-topic-title {\n            font-weight: 700;\n        }\n\n        [season-topic-focus] > .season-topic-box {\n            fill: #ff0;\n            fill-opacity: 0.9;\n            stroke: #000;\n            stroke-opacity: 0.7;\n            stroke-width: 2px;\n            stroke-dasharray: none;\n        }\n\n        [season-topic-focus] > .season-topic-title {\n            fill: #000;\n        }\n    ]]>\n    </style>\n    <g eblock-template="" season-topic-global="">\n        <g season-topic-children-group="" />\n        <g season-topic-content-group="" tabindex="0" >\n            <rect class="season-topic-box" />\n            <text class="season-topic-title" season-topic-content-type="title" />\n            <use class="season-topic-image" season-topic-content-type="image" href="" />\n            <g season-topic-extends="" />\n            <use href="#" season-topic-content-type="fold" />\n        </g>\n    </g>\n</svg>\n',"image/svg+xml").querySelector("svg"));function rt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return at(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return at(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,r=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw r}}}}function at(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function st(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=S(e);if(t){var o=S(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return L(this,n)}}function ct(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}P(ot,{getEventPointInGraphic:Ke,clearDragoverTimer:Je,prepareDragTipElements:function(e,t){if(e instanceof m&&e.$assignedNode instanceof SVGGraphicsElement&&t){var n=e.$assignedNode.ownerSVGElement;if(n){var i=n.querySelector(".season-topic-drag-group");if(!i&&(i=t.dragStubNode=document.createElementNS("http://www.w3.org/2000/svg","g"))){i.setAttribute("class","season-topic-drag-group");var o=e.acquireNode(":scope > [season-topic-content-group]"),r={$width:0,$height:0,$x:0,$y:0};if(o){var a=(o=o.cloneNode(!0)).querySelector(".season-topic-box");a&&(a=a.cloneNode())&&(a.setAttribute("class","season-topic-drag-mask"),r.$width=parseInt(a.getAttribute("width"))||0,r.$height=parseInt(a.getAttribute("height"))||0),o.appendChild(a),(a=o.querySelector('[season-topic-content-type="fold"]'))&&a.remove(),i.appendChild(o)}n.appendChild(i),Object.assign(i,r)}var s=n.querySelector(".season-topic-drag-line");s||(s=t.dragLine=document.createElementNS("http://www.w3.org/2000/svg","path"))&&(s.setAttribute("class","season-topic-drag-line"),n.appendChild(s))}}},clearDragTipElements:Qe,updateDragTipElements:Ze,clearDragContext:et,onFactorRegister:function(e){V(e instanceof c,M,-1,"_container must be an instance of EBlockContainer"),e.enableDomEvent("click"),e.enableDomEvent("dblclick"),e.enableDomEvent("mousedown"),e.enableDomEvent("mousemove"),e.enableDomEvent("mouseover"),e.enableDomEvent("mouseout"),e.enableDomEvent("mouseup"),e.enableDomEvent("keydown"),e.addEventListener("topic-domevent-mousemove",tt.binding(e)),e.addEventListener("topic-domevent-mouseup",nt.binding(e)),e.addEventListener("topic-domevent-keydown",it.binding(e))},onFactorUnregister:function(e){V(e instanceof c,M,-1,"_container must be an instance of EBlockContainer"),e.disableDomEvent("click"),e.disableDomEvent("dblclick"),e.disableDomEvent("mousedown"),e.disableDomEvent("mousemove"),e.disableDomEvent("mouseover"),e.disableDomEvent("mouseout"),e.disableDomEvent("mouseup"),e.disableDomEvent("keydown"),e.removeEventListener("topic-domevent-mousemove",tt.binding(e)),e.removeEventListener("topic-domevent-mouseup",nt.binding(e)),e.removeEventListener("topic-domevent-keydown",it.binding(e)),tt.deleteBinding(e),nt.deleteBinding(e),it.deleteBinding(e)}});var lt=new WeakMap,ut=new WeakMap,pt=new WeakMap,dt=function(e){E(n,e);var t=st(n);function n(e,i){var o;y(this,n),V(e instanceof We,M,-1,"_doc must be an instance of MindmapDocument"),ct(k(o=t.call(this,i,e.env)),lt,{writable:!0,value:void 0}),ct(k(o),ut,{writable:!0,value:void 0}),ct(k(o),pt,{writable:!0,value:void 0}),I(k(o),"UIControlMap",{"ctrl-wheel":{action:"zoom-view",args:[{}]},mousemiddle:{action:"move-view"},arrowright:{action:"goto-topic-with-direction",args:[!0]},arrowleft:{action:"goto-topic-with-direction",args:[!1]},arrowup:{action:"gotoPreviousSiblingTopic"},arrowdown:{action:"gotoNextSiblingTopic"},f2:{action:"editFocusTopic"},delete:{action:"deleteFocusTopic"},tab:{action:"createChildTopic"},enter:{action:"createSiblingTopic"}});var r=e.env;P(k(o),"doc",e),o.enableDomEvent("wheel"),o.enableDomEvent("contextmenu"),ot.register(k(o)),C(k(o),ut,void 0),C(k(o),lt,{}),C(k(o),pt,{});var a,s=rt(Object.getOwnPropertyNames(o.constructor.prototype));try{for(s.s();!(a=s.n()).done;){var c=a.value;if(c.startsWith("@")){var l=o[c];"function"==typeof l&&(c=c.substring(1),l=T(k(o),lt)[c]=l.bind(k(o)),r.addEventListener(c,l))}}}catch(e){s.e(e)}finally{s.f()}return o}return w(n,[{key:"dispose",value:function(){for(var e in T(this,lt))this.env.removeEventListener(e,T(this,lt)[e]);this.disableDomEvent("wheel"),this.disableDomEvent("contextmenu"),ee.prototype.dispose.call(this)}},{key:"sheetID",get:function(){return T(this,ut)}},{key:"rootTopic",get:function(){return Ne.getFirstChildTopic(this.stageContainer)}},{key:"focusTopic",get:function(){return Ne.getFocusTopic(this.stageContainer)}},{key:"getTopicByID",value:function(e){return Ne.getTopicByID(this.stageContainer,e)}},{key:"createChildTopic",value:function(){var e=this.focusTopic;return e&&(e=e.createChild(G({},this.doc.constructor.DefaultTopicTemplate))),e&&e.setFocus().render().showInView().notify("topic-event-edit",{eventTarget:e}),this}},{key:"createSiblingTopic",value:function(){var e=this.focusTopic,t=e&&(e.parentTopic||e);return t&&(e=t.createChild(G({},this.doc.constructor.DefaultTopicTemplate),e.nextSiblingTopic)),e&&e.setFocus().render().showInView().notify("topic-event-edit",{eventTarget:e}),this}},{key:"editFocusTopic",value:function(e){var t=this.focusTopic;return t&&t.showInView().notify("topic-event-edit",{eventTarget:t,triggerContentType:e}),this}},{key:"deleteFocusTopic",value:function(){var e=this.focusTopic,t=e&&(e.nextSiblingTopic||e.previousSiblingTopic||e.parentTopic);return e&&e.drop(),t&&t.setFocus().render().showInView(),this}},{key:"gotoNextSiblingTopic",value:function(){var e=this.focusTopic;return e&&(e=e.nextSiblingTopic),e&&e.setFocus(),this}},{key:"gotoPreviousSiblingTopic",value:function(){var e=this.focusTopic;return e&&(e=e.previousSiblingTopic),e&&e.setFocus(),this}},{key:"gotoParentTopic",value:function(){var e=this.focusTopic;return e&&(e=e.parentTopic),e&&e.setFocus(),this}},{key:"gotoChildrenTopic",value:function(){var e=this.focusTopic;return e&&(e=e.firstChildTopic),e&&e.setFocus(),this}},{key:"render",value:function(){return this.rootTopic.render(),this}},{key:"exportImage",value:function(e){e||(e={}),this.env.fireEvent("topic-event-cancel-edit");var t=this.stageContainer.getBBox(),n=t.x,i=t.y,o=t.width,r=t.height,a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),a.setAttribute("overflow","hidden"),a.setAttribute("width",o),a.setAttribute("height",r),a.setAttribute("viewBox","".concat(n," ").concat(i," ").concat(o," ").concat(r)),a.insertAdjacentHTML("afterbegin",this.svgElement.innerHTML);var s='<?xml version="1.0" standalone="no"?>\r\n'+(new XMLSerializer).serializeToString(a);return this.env.getImageData("data:image/svg+xml;charset=utf-8,"+encodeURIComponent(s),{width:o,height:r,type:e.type,toBlob:e.toBlob})}},{key:"@topic-event-view-export-image",value:function(e){e&&e.detail&&(e.detail.image=this.exportImage(e.detail.option))}},{key:"@topic-event-view-switch-sheet",value:function(e){var t=this;if(e.detail){this.env.fireEvent("topic-event-cancel-edit");var n=e.detail&&e.detail.sheet;if(n&&n.id){var i=this.rootTopic;i&&i.drop((function(e){return e+1})),i=ot.generate(this.stageContainer,Ne,G({},n.topic),0,this.env).render().queueAction((function(){C(t,ut,n.id),i&&i.showInCenterOfView()}))}}}},{key:"@topic-event-view-submit",value:function(e){var t=this.rootTopic.exportTopicData(),n=e&&e.detail;if(t&&n){var i=n.sheets;if(i instanceof Array&&i.push({sheetID:T(this,ut),topicData:t}),this.rootTopic.collectImageStorage(),n.attachments)for(var o in this.rootTopic.enumerateImageInStorage())n.attachments[o.sourceURL]=o.href}}},{key:"@topic-domevent-mousedown",value:function(e){var t=e&&e.detail,i=t&&t.originEvent;t&&!t.eventTarget&&n.dispatchControlMapAction(i,this)}},{key:"@topic-domevent-mousemove",value:function(e){var t=this,i=e&&e.detail,o=i&&i.originEvent;i&&!i.eventTarget&&(n.dispatchControlMapAction(o,this,(function(e){T(t,pt).type&&T(t,pt).type!==e.action&&(T(t,pt).type=void 0)}))||T(this,pt).type&&(T(this,pt).type=void 0))}},{key:"@topic-domevent-mouseup",value:function(e){var t=e&&e.detail,n=t&&t.originEvent;t&&!t.eventTarget&&T(this,pt).type&&this[T(this,pt).type](n)}},{key:"@topic-domevent-click",value:function(e){var t=e&&e.detail,n=t&&!t.eventTarget&&this.focusTopic&&this.focusTopic;n&&n.killFocus()}},{key:"@topic-domevent-wheel",value:function(e){var t=e&&e.detail,i=t&&t.originEvent;t&&n.dispatchControlMapAction(i,this)}},{key:"@topic-domevent-keydown",value:function(e){var t=e&&e.detail,i=t&&t.originEvent;n.dispatchControlMapAction(i,this)&&(i.preventDefault(),i.stopPropagation())}},{key:"@topic-domevent-contextmenu",value:function(e){var t=e&&e.detail,n=t&&t.originEvent;n.preventDefault(),n.stopPropagation()}},{key:"move-view",value:function(e){if(e instanceof WheelEvent)this.move(e.deltaX,e.deltaY),e.preventDefault(),e.stopPropagation();else if(e instanceof MouseEvent){var t=T(this,pt);if("mousedown"===e.type)t.type="$move-view",t.x=e.clientX,t.y=e.clientY,this.svgElement.style.cursor="grabbing";else if("mousemove"===e.type){if("$move-view"===t.type){var n=t.x-e.clientX,i=t.y-e.clientY;t.x=e.clientX,t.y=e.clientY;var o=Ne.convertWindowPointToGraphic(this.svgElement,n,i);this.move(o.x,o.y)}e.preventDefault(),e.stopPropagation()}else t.type=null,this.svgElement.style.cursor=""}}},{key:"zoom-view",value:function(e,t){if(t||(t={}),e instanceof WheelEvent){var n="x"===t.by?e.deltaX>0:"z"===t.by?e.deltaZ>0:e.deltaY>0;n=n?this.scale-(Number(t.delta)||.02):this.scale+(Number(t.delta)||.02),this.scale=Math.min(Math.max(n,Number(t.min)||.1),Number(t.max)||2),e.preventDefault(),e.stopPropagation()}else if(e instanceof MouseEvent){var i=T(this,pt);if("mousedown"===e.type)i.type="$zoom-view",i.x=e.clientX,i.y=e.clientY,this.svgElement.style.cursor="zoom-in";else if("mousemove"===e.type){if("$zoom-view"===i.type){var o="x"===t.by?i.x<e.clientX:i.y<e.clientY;o=o?0-(Number(t.delta)||.02):Number(t.delta)||.02,i.x=e.clientX,i.y=e.clientY,this.svgElement.style.cursor=o>0?"zoom-in":"zoom-out",this.scale=Math.min(Math.max(this.scale+o,Number(t.min)||.1),Number(t.max)||2)}}else i.type=null,this.svgElement.style.cursor="";e.preventDefault(),e.stopPropagation()}}},{key:"goto-topic-with-direction",value:function(e,t){var n=this.focusTopic;if(n){if(n.level<1){for(n=n.firstChildTopic;n;n=n.nextSiblingTopic)if(n.direction==t){n.setFocus();break}}else n.direction==t?this.gotoChildrenTopic():this.gotoParentTopic();e.preventDefault(),e.stopPropagation()}}}],[{key:"getContrlMapKey",value:function(e){var t=[];return e instanceof UIEvent&&(e.ctrlKey&&t.push("ctrl"),e.altKey&&t.push("alt"),e.shiftKey&&t.push("shift"),e instanceof MouseEvent?(e instanceof WheelEvent&&t.push("wheel"),0!=(1&e.buttons)&&t.push("mouseleft"),0!=(2&e.buttons)&&t.push("mouseright"),0!=(4&e.buttons)&&t.push("mousemiddle"),0!=(8&e.buttons)&&t.push("mouseback"),0!=(16&e.buttons)&&t.push("mouseforward")):e instanceof KeyboardEvent&&t.push(String(e.key).toLocaleLowerCase())),t.join("-")}},{key:"dispatchTopicEventAction",value:function(e,t){var n=e instanceof Event?e.detail:e,i=n&&this[n.triggerContentType||"title"],o=i&&i[t||e instanceof Event&&String(e.type).replace(/^topic-event-/gi,"")];"function"==typeof o&&o(n)}},{key:"dispatchControlMapAction",value:function(e,t,i){var o=n.getContrlMapKey(e),r=t.UIControlMap[o];if(r){var a=r.action;if("function"==typeof a||t[a],"function"==typeof a)return"function"==typeof i&&i(r),a.apply(void 0,[e].concat(ne(r.args||[]))),r}}}]),n}(ee);
/**
                           * @author season <season-studio@outlook.com>
                           * @license Apache-2.0
                           */
function ht(e,t,n){return new H((new DOMParser).parseFromString(e,t||"image/svg+xml").querySelector(n||"svg"))}var ft=[ht('\n<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n    <defs eblock-predefined="" d-tag="topic-priority">\n        <symbol id="topic-priority-1" width="20" height="20" viewBox="-1 -1 22 22">\n            <path fill="#f00" fill-opacity="0.8" stroke="#fff" stroke-width="2" stroke-opacity="0.8" d="M1 10A9 9 0 1 1 20 10A9 9 0 1 1 1 10M8 7L10.5 6V16"></path>\n        </symbol>\n        <symbol id="topic-priority-2" width="20" height="20" viewBox="-1 -1 22 22">\n            <path fill="#f00" fill-opacity="0.8" stroke="#fff" stroke-width="2" stroke-opacity="0.8" d="M1 10A9 9 0 1 1 20 10A9 9 0 1 1 1 10M7 8C10.5 1 20 8 7 14M6 14H16"></path>\n        </symbol>\n        <symbol id="topic-priority-3" width="20" height="20" viewBox="-1 -1 22 22">\n            <path fill="#f0f" fill-opacity="0.8" stroke="#fff" stroke-width="2" stroke-opacity="0.8" d="M1 10A9 9 0 1 1 20 10A9 9 0 1 1 1 10M7 7C10.5 1 20 8 10 10C21 10 10.5 21 6 12"></path>\n        </symbol>\n        <symbol id="topic-priority-4" width="20" height="20" viewBox="-1 -1 22 22">\n            <path fill="#f0f" fill-opacity="0.8" stroke="#fff" stroke-width="2" stroke-opacity="0.8" d="M1 10A9 9 0 1 1 20 10A9 9 0 1 1 1 10M12 4Q10 10 6 13M5 13H15M13 8L11 16"></path>\n        </symbol>\n        <symbol id="topic-priority-5" width="20" height="20" viewBox="-1 -1 22 22">\n            <path fill="#06f" fill-opacity="0.8" stroke="#fff" stroke-width="2" stroke-opacity="0.8" d="M1 10A9 9 0 1 1 20 10A9 9 0 1 1 1 10M9 4Q9 7 8 9M7 9C18 5 16 20 6 14M9 5H14"></path>\n        </symbol>\n        <symbol id="topic-priority-6" width="20" height="20" viewBox="-1 -1 22 22">\n            <path fill="#06f" fill-opacity="0.8" stroke="#fff" stroke-width="2" stroke-opacity="0.8" d="M1 10A9 9 0 1 1 20 10A9 9 0 1 1 1 10M7 9C13 7 16 13 10 15C4 15 4 9 13 4"></path>\n        </symbol>\n        <symbol id="topic-priority-7" width="20" height="20" viewBox="-1 -1 22 22">\n            <path fill="#093" fill-opacity="0.8" stroke="#fff" stroke-width="2" stroke-opacity="0.8" d="M1 10A9 9 0 1 1 20 10A9 9 0 1 1 1 10M7 8V6Q11 7 13 6.5Q10 12 9 16"></path>\n        </symbol>\n        <symbol id="topic-priority-8" width="20" height="20" viewBox="-1 -1 22 22">\n            <path fill="#093" fill-opacity="0.8" stroke="#fff" stroke-width="2" stroke-opacity="0.8" d="M1 10A9 9 0 1 1 20 10A9 9 0 1 1 1 10M10 9C6 8 7 3 12 4C15 5 15 10 10 9C16 10 16 16.5 10 16C4 15 4 9 10 9"></path>\n        </symbol>\n        <symbol id="topic-priority-9" width="20" height="20" viewBox="-1 -1 22 22">\n            <path fill="#993" fill-opacity="0.8" stroke="#fff" stroke-width="2" stroke-opacity="0.8" d="M1 10A9 9 0 1 1 20 10A9 9 0 1 1 1 10M15 10C6 16 5 3.5 12 4.5C18 6 16 17 7 16"></path>\n        </symbol>\n    </defs>\n    <script eblock-script="">\n    <![CDATA[\n        declarer.getExtensionInfo = function () {\n            return {\n                name: "priority"\n            };\n        }\n        declarer.onRendering = function (_data) {\n            if (_data) {\n                let priority = Number(_data.priority);\n                if (priority && (priority > 0) && (priority < 10)) {\n                    this.$assignedNode.setAttribute("href", "#topic-priority-" + priority);\n                } else {\n                    this.unmount();\n                }\n            }\n        }\n    ]]>\n    <\/script>\n    <use eblock-template="" season-topic-content-type="priority" ebevent-rendering="onRendering"></use>\n</svg>\n'),ht('\n<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n    <defs eblock-predefined="" d-tag="topic-task-marker">\n        <symbol id="topic-task-marker-0" width="20" height="20" viewBox="-1 -1 22 22">\n            <path fill="#fff" fill-opacity="0.8" stroke="#093" stroke-width="1" stroke-opacity="0.8" d="M1 10A9 9 0 1 1 20 10A9 9 0 1 1 1 10M8 14V5L15 10L8 15V6"></path>\n        </symbol>\n        <symbol id="topic-task-marker-1" width="20" height="20" viewBox="-1 -1 22 22">\n            <circle cx="10.5" cy="10.5" r="10" stroke="none" fill="#093" fill-opacity="0.8"></circle>\n            <path stroke="none" fill="#fff" fill-opacity="0.8" d="M10.5 10.5V2A8.5 8.5 180 1 0 16.5 4.5L10.5 10.5"></path>\n        </symbol>\n        <symbol id="topic-task-marker-2" width="20" height="20" viewBox="-1 -1 22 22">\n            <circle cx="10.5" cy="10.5" r="10" stroke="none" fill="#093" fill-opacity="0.8"></circle>\n            <path stroke="none" fill="#fff" fill-opacity="0.8" d="M10.5 10.5V2A8.5 8.5 180 1 0 19 10.5L10.5 10.5"></path>\n        </symbol>\n        <symbol id="topic-task-marker-3" width="20" height="20" viewBox="-1 -1 22 22">\n            <circle cx="10.5" cy="10.5" r="10" stroke="none" fill="#093" fill-opacity="0.8"></circle>\n            <path stroke="none" fill="#fff" fill-opacity="0.8" d="M10.5 10.5V2A8.5 8.5 180 1 0 16.5 16.5L10.5 10.5"></path>\n        </symbol>\n        <symbol id="topic-task-marker-4" width="20" height="20" viewBox="-1 -1 22 22">\n            <circle cx="10.5" cy="10.5" r="10" stroke="none" fill="#093" fill-opacity="0.8"></circle>\n            <path stroke="none" fill="#fff" fill-opacity="0.8" d="M10.5 10.5V2A8.5 8.5 180 0 0 10.5 19L10.5 10.5"></path>\n        </symbol>\n        <symbol id="topic-task-marker-5" width="20" height="20" viewBox="-1 -1 22 22">\n            <circle cx="10.5" cy="10.5" r="10" stroke="none" fill="#093" fill-opacity="0.8"></circle>\n            <path stroke="none" fill="#fff" fill-opacity="0.8" d="M10.5 10.5V2A8.5 8.5 180 0 0 4.5 16.5L10.5 10.5"></path>\n        </symbol>\n        <symbol id="topic-task-marker-6" width="20" height="20" viewBox="-1 -1 22 22">\n            <circle cx="10.5" cy="10.5" r="10" stroke="none" fill="#093" fill-opacity="0.8"></circle>\n            <path stroke="none" fill="#fff" fill-opacity="0.8" d="M10.5 10.5V2A8.5 8.5 180 0 0 2 10.5L10.5 10.5"></path>\n        </symbol>\n        <symbol id="topic-task-marker-7" width="20" height="20" viewBox="-1 -1 22 22">\n            <circle cx="10.5" cy="10.5" r="10" stroke="none" fill="#093" fill-opacity="0.8"></circle>\n            <path stroke="none" fill="#fff" fill-opacity="0.8" d="M10.5 10.5V2A8.5 8.5 180 0 0 4.5 4.5L10.5 10.5"></path>\n        </symbol>\n        <symbol id="topic-task-marker-8" width="20" height="20" viewBox="-1 -1 22 22">\n            <path fill="#093" fill-opacity="0.8" stroke="#fff" stroke-width="2" stroke-opacity="0.8" d="M1 10A9 9 0 1 1 20 10A9 9 0 1 1 1 10M15 6L10 13L6 9"></path>\n        </symbol>\n        <symbol id="topic-task-marker-unknown" width="20" height="20" viewBox="-1 -1 22 22">\n            <path fill="#fff" fill-opacity="0.8" stroke="#093" stroke-width="1" stroke-opacity="0.8" d="M1 10A9 9 0 1 1 20 10A9 9 0 1 1 1 10M7 8A3.5 3.5 0 1 1 10.5 10.5V13M10.5 14V16M9.5 15H11.5"></path>\n        </symbol>\n    </defs>\n    <script eblock-script="">\n    <![CDATA[\n        declarer.getExtensionInfo = function () {\n            return {\n                name: "task-marker"\n            };\n        }\n        declarer.onRendering = function (_data) {\n            if (_data && ("task-marker" in _data)) {\n                let task = Number(_data["task-marker"]);\n                if ((task >= 0) && (task <= 8)) {\n                    this.$assignedNode.setAttribute("href", "#topic-task-marker-" + task);\n                } else {\n                    this.$assignedNode.setAttribute("href", "#topic-task-marker-unknown");\n                }\n            } else {\n                this.unmount();\n            }\n        }\n    ]]>\n    <\/script>\n    <use eblock-template="" season-topic-content-type="task-marker" ebevent-rendering="onRendering"></use>\n</svg>\n'),ht('\n<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n    <style eblock-predefined="" d-tag="topic-href">\n        .season-topic-href {\n            fill: rgba(255,255,255,0.05);\n            stroke: none;\n        }\n        .season-topic-href > use {\n            fill: #333;\n        }\n        .season-topic-href:hover {\n            fill: var(--topic-ui-focus-color);\n            stroke: none;\n        }\n        .season-topic-href:hover > use {\n            fill: var(--topic-ui-emphasize-front-color);\n        }\n    </style>\n    <defs eblock-predefined="" d-tag="topic-href">\n        <symbol id="topic-href-link-icon" width="20" height="20" viewBox="0 0 20 20">\n            <path d="M 19,7.115 13.63,2.5 v 2.692 c -8.226,0.08 -8.339,8.658 -8.339,8.658 0,0 1.746,-4.562 8.339,-4.619 v 2.499 z"></path>\n            <path d="m 15.77,11.44 v 4.91 H 4.127 V 4.424 H 12.5 V 3.269 H 3 V 17.5 l 13.89,-0.1 v -6.95 z"></path>\n        </symbol>\n        <symbol id="topic-href-resource-icon" width="20" height="20" viewBox="0 0 20 20">\n            <path d="m 4.407,16.36 c -1.535,-1.53 -1.536,-4.02 -0,-5.55 L 11.87,3.344 c 1.11,-1.125 2.97,-1.125 4.09,0 1.12,1.126 1.12,2.968 0,4.094 L 9.086,14.31 c -0.729,0.73 -1.902,0.73 -2.632,0 -0.731,-0.72 -0.729,-1.9 0,-2.63 L 9.97,8.17 10.84,9.045 7.332,12.56 c -0.245,0.25 -0.247,0.63 0,0.87 0.248,0.25 0.63,0.25 0.876,0 L 15.08,6.56 c 0.65,-0.643 0.65,-1.696 0,-2.34 -0.65,-0.642 -1.7,-0.642 -2.34,0 l -7.457,7.47 c -1.05,1.04 -1.047,2.73 0,3.79 1.052,1.05 2.746,1.05 3.797,0 l 3.08,-3.08 0.88,0.87 -3.08,3.08 c -1.537,1.54 -4.022,1.53 -5.557,0 z"></path>\n        </symbol>\n    </defs>\n    <script eblock-script="">\n    <![CDATA[\n        declarer.getExtensionInfo = function () {\n            return {\n                name: "href"\n            };\n        }\n        declarer.onRendering = function (_data, _, _topic) {\n            if (!_data || !_data.href) {\n                this.unmount();\n            } else {\n                let type = _topic.env.getHRefType(_data.href);\n                let node = this.$assignedNode.querySelector(":scope > use");\n                node && node.setAttribute("href", (type === "link") ? "#topic-href-link-icon" : "#topic-href-resource-icon");\n            }\n        }\n    ]]>\n    <\/script>\n    <g eblock-template="" season-topic-content-type="href" class="season-topic-href" ebevent-rendering="onRendering">\n        <rect width="20" height="20" rx="3" ry="3"></rect>\n        <use href="#topic-href-link-icon"></use>\n    </g>\n</svg>\n'),ht('\n<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n    <style eblock-predefined="" d-tag="topic-labels">\n        .season-topic-label > rect {\n            fill: rgba(255,255,255,0.7);\n            stroke-width: 0.5px;\n            stroke-dasharray: 2;\n            stroke: #666;\n            rx: 5px;\n            ry: 5px;\n        }\n        .season-topic-label > text {\n            alignment-baseline: before-edge;\n            dominant-baseline: text-before-edge;\n            font-size: 0.8em;\n            fill: #666;\n        }\n    </style>\n    <script eblock-script="">\n    <![CDATA[\n        declarer.getExtensionInfo = function () {\n            return {\n                name: "labels"\n            };\n        }\n        declarer.onRendering = function (_data, _, _topic) {\n            const labels = (_data && _data.labels);\n            if (!labels || !_data.labels.length) {\n                this.unmount();\n            } else {\n                const renderedLabels = [];\n                this.$assignedNode.querySelectorAll(".season-topic-label").forEach(item => {\n                    let labelVal = item.getAttribute("d-label");\n                    if (!labels.includes(labelVal)) {\n                        item.remove();\n                    } else {\n                        renderedLabels.push(labelVal);\n                    }\n                });\n                labels.forEach(item => {\n                    if (!renderedLabels.includes(item)) {\n                        let gNode = document.createElementNS("http://www.w3.org/2000/svg", "g");\n                        gNode.setAttribute("class", "season-topic-label");\n                        gNode.innerHTML = \'<text transform="translate(2, 2)">\' + item + \'</text>\';\n                        this.$assignedNode.appendChild(gNode);\n                        let box = gNode.getBBox();\n                        gNode.insertAdjacentHTML("afterbegin", \'<rect x="0" y="0" width="\' + String(parseInt(box.width) + 4) + \'" height="\' + String(parseInt(box.height) + 4) + \'" />\');\n                    }\n                });\n                let x = 0;\n                this.$assignedNode.querySelectorAll(".season-topic-label").forEach(item => {\n                    item.setAttribute("transform", "translate(" + x + ",0)");\n                    let box = item.getBBox();\n                    x += box.width + 2;\n                });\n            }\n        }\n    ]]>\n    <\/script>\n    <g eblock-template="" season-topic-content-type="labels" class="season-topic-labels" ebevent-rendering="onRendering">\n    </g>\n</svg>\n'),ht('\n<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n    <style eblock-predefined="" d-tag="topic-notes">\n        .season-topic-notes {\n            fill: rgba(255,255,255,0.05);\n            stroke: none;\n        }\n        .season-topic-notes > use {\n            fill: rgba(255,255,255,0.3);\n            stroke-width: 1.5px;\n            stroke: #111;\n        }\n        .season-topic-notes:hover > use {\n            fill: #fff;\n            stroke-width: 1.5px;\n            stroke: #000;\n        }\n    </style>\n    <script eblock-script="">\n    <![CDATA[\n        declarer.getExtensionInfo = function () {\n            return {\n                name: "notes"\n            };\n        }\n        declarer.onRendering = function (_data, _, _topic) {\n            if (!_data || !_data.notes) {\n                this.unmount();\n            }\n        }\n    ]]>\n    <\/script>\n    <g eblock-template="" season-topic-content-type="notes" class="season-topic-notes" ebevent-rendering="onRendering">\n        <use href="#season-topic-predefine-image-nodepad" width="20" height="20" />\n    </g>\n</svg>\n')];function vt(e,t,n,i){var o=i[e.getAttribute("mmap-layout-background")];if("function"==typeof o){var r=e.getBBox(),a=r.x>=0?0:r.x,s=r.y>=0?0:r.y,c=r.width+2*Math.abs(r.x),l=r.height+2*Math.abs(r.y);(t=o.call(this,t,{left:a,top:s,width:c,height:l},e,n,i))&&(t.classList.add("mmap-layout-background"),"none"===t.style.display&&(t.style.display=""),e.insertAdjacentElement("afterbegin",t))}else t&&t.remove()}function gt(e,t,n){var i=this;e.querySelectorAll(":scope > *").forEach((function(e){return yt.call(i,e,t,n)}))}function mt(e,t){var n,i,o=(n=e.getAttribute("mmap-layout-max-width"),i=t.maxWidth,Math.min(Number(n)||Number.MAX_VALUE,Number(i)||Number.MAX_VALUE)),r=Number(e.getAttribute("mmap-layout-margin")||void 0);isNaN(r)&&(r=Number(t.margin)||0);var a=Number(e.getAttribute("mmap-layout-padding")||void 0);return isNaN(a)&&(a=Number(t.padding)||0),{maxWidth:o,margin:r,padding:a}}function yt(e,t,n){t||(t={});var i=e.querySelector(".mmap-layout-background");i&&(i.style.display="none");var o=e.getAttribute("mmap-layout"),r=wt.layout[o]||gt;"function"==typeof r&&r.call(this,e,t,n),vt.call(this,e,i,t,n)}var bt=new WeakMap;function wt(e,t,n){var i,o=this;if(!(this instanceof wt))return q(wt,Array.prototype.slice.call(arguments));if(V(e instanceof SVGGraphicsElement,Error,"_parentNode must be an instance of SVGGraphicsElement"),V(t,Error,"_content must be an instance of Node or a XML snippet of the content"),n||(n={}),n.singletonStamp){var r=e.querySelector(':scope > [mmap-singleton="'.concat(n.singletonStamp,'"]')),a=r&&bt.get(r);if(a instanceof wt){if(void 0===n.singletonMutex||String(n.singletonMutex)===r.getAttribute("mmap-singleton-mutex"))return a;a.close()}}if(t instanceof Node?i=t:(i=document.createElementNS("http://www.w3.org/2000/svg","g")).insertAdjacentHTML("afterbegin",t),n.singletonStamp&&(i.setAttribute("mmap-singleton",n.singletonStamp),void 0!==n.singletonMutex&&i.setAttribute("mmap-singleton-mutex",n.singletonMutex)),e.appendChild(i),bt.set(i,this),n.rootAttrs)for(var s in n.rootAttrs)i.setAttribute(s,n.rootAttrs[s]);var c=function(){i.remove()}.bind(this),l=function(){e.appendChild(i),"relayout"===i.getAttribute("mmap-bind-hide-in-render")&&this.relayout()}.bind(this),u=function(e){var t=this;try{e.path.forEach((function(o){var r=o.getAttribute("mmap-event-click"),a=r&&n[r];if("function"==typeof a)throw a.call(t,e,o,n,r),e.preventDefault(),e.stopPropagation(),null;if(o===i)throw e.preventDefault(),e.stopPropagation(),null}))}catch(e){e&&console.warn("Fail in processing click event in MindmapAddinPanel",e)}}.bind(this),p=function(e){var t=this;try{e.path.forEach((function(o){var r=o.getAttribute("mmap-event-dblclick"),a=r&&n[r];if("function"==typeof a)throw a.call(t,e,o,n,r),e.preventDefault(),e.stopPropagation(),null;if(o===i)throw e.preventDefault(),e.stopPropagation(),null}))}catch(e){e&&console.warn("Fail in processing dblclick event in MindmapAddinPanel",e)}}.bind(this),d=function(e){var t=this;try{e.path.forEach((function(o){var r=o.getAttribute("mmap-event-keydown"),a=r&&n[r];if("function"==typeof a)throw a.call(t,e,o,n,r),null;if(o===i)throw"input"!==String(e.target.nodeName).toLowerCase()&&!Boolean(e.target.getAttribute("contenteditable"))&&e.preventDefault(),null}))}catch(e){e&&console.warn("Fail in processing dblclick event in MindmapAddinPanel",e)}finally{e.stopPropagation()}}.bind(this),h=function(e){var t=e.detail,n=i.getAttribute("topic-event-trigger"===e.type?"mmap-bind-filter-trigger":"mmap-bind-filter-edit");t&&n&&t.triggerContentType!==n&&this.close()}.bind(this);function f(e){e.stopPropagation()}function v(e){e.stopPropagation()}var g=function(){"function"==typeof n.onClose&&n.onClose.call(this,n),n.env&&(n.env.removeEventListener("topic-event-cancel-edit",g),n.env.removeEventListener("topic-event-before-render",c),n.env.removeEventListener("topic-event-after-render",l),n.env.removeEventListener("topic-event-trigger",h),n.env.removeEventListener("topic-event-edit",h)),i.removeEventListener("click",u),i.removeEventListener("dblclick",p),i.removeEventListener("mousedown",f),i.removeEventListener("mouseup",v),i.removeEventListener("keydown",d);var t=i.ownerSVGElement;t?t.focus():e.focus(),i.remove()}.bind(this);P(this,{rootNode:i,relayout:function(){"function"==typeof n.onBeforeLayout&&n.onBeforeLayout.call(o,n),yt.call(o,i,void 0,n),"function"==typeof n.onAfterLayout&&n.onAfterLayout.call(o,n)},close:g}),i.addEventListener("click",u),i.addEventListener("dblclick",p),i.addEventListener("mousedown",f),i.addEventListener("mouseup",v),i.addEventListener("keydown",d),n.env&&(i.hasAttribute("mmap-bind-cancel-edit")&&n.env.addEventListener("topic-event-cancel-edit",g),i.hasAttribute("mmap-bind-hide-in-render")&&(n.env.addEventListener("topic-event-before-render",c),n.env.addEventListener("topic-event-after-render",l)),i.hasAttribute("mmap-bind-filter-trigger")&&n.env.addEventListener("topic-event-trigger",h),i.hasAttribute("mmap-bind-filter-edit")&&n.env.addEventListener("topic-event-edit",h)),"function"==typeof n.onInitialize&&n.onInitialize.call(this,n),this.relayout()}var kt="fill:#fff;stroke-width:0.5px;stroke:#ccc;filter:drop-shadow(0px 3px 5px #aaa);";function xt(e){return new Promise(((t,n)=>{try{const i=document.createElement("input");i.type="file",e&&(i.accept=e),i.addEventListener("change",(()=>{const e=i.files;e.length>0?t(e[0]):n(0)})),i.click()}catch(e){n(e)}}))}P(wt,{layout:P({},{line:function(e,t,n){var i=this,o=mt(e,t),r=o.maxWidth,a=o.margin,s=o.padding,c=s,l=s,u=0;e.querySelectorAll(":scope > *").forEach((function(e){if(yt.call(i,e,o,n),e instanceof SVGGraphicsElement){var t=e.getBBox(),p=t.width,d=t.height;if(p>0){var h=e.getAttribute("predefine-transform");c+p+s>r?(c=s,l+=u+a,u=d):u<d&&(u=d),e.setAttribute("transform",h?"translate(".concat(c,",").concat(l,"),").concat(h):"translate(".concat(c,",").concat(l,")")),c+=p+a}}}))},row:function(e,t,n){var i=this,o=mt(e,t),r=o.margin,a=o.padding,s=[],c=a,l=a;e.querySelectorAll(":scope > *").forEach((function(e){if(yt.call(i,e,o,n),e instanceof SVGGraphicsElement){var t=e.getBBox(),a=t.width,u=t.height;if(a>0&&u>0){if("right"===e.getAttribute("mmap-layout-align"))s.push({y:c,node:e,width:a});else{var p=e.getAttribute("predefine-transform");e.setAttribute("transform",p?"translate(".concat(l,",").concat(c,"),").concat(p):"translate(".concat(l,",").concat(c,")"))}c+=u+r}}}));var u=e.getBBox().width;s.forEach((function(e){var t=e.node.getAttribute("predefine-transform");e.node.setAttribute("transform",t?"translate(".concat(u-e.width,",").concat(e.y,"),").concat(t):"translate(".concat(u-e.width,",").concat(e.y,")"))}))}}),InstanceMap:bt,backgroundGenerator:P({},{dialogBubbleBackground:function(e,t,n,i,o,r){var a=t.left,s=t.top,c=t.width,l=t.height;return e instanceof SVGPathElement||(e&&e.remove(),e=document.createElementNS("http://www.w3.org/2000/svg","path")),e&&(r||(r={}),e.setAttribute("d",function(e,t,n,i,o,r,a,s,c){Xe.includes(c)||(c="top");var l=[];if(l.push("M".concat(e+o," ").concat(t)),"top"===c){var u=Ye(n,o,s,a);u[0]>0&&l.push("h".concat(u[0])),l.push("l".concat(a," ").concat(0-r,"l").concat(a," ").concat(r)),u[1]>0&&l.push("h".concat(u[1]))}else l.push("h".concat(n-2*o));if(l.push("a".concat(o," ").concat(o," 0 0 1 ").concat(o," ").concat(o)),"right"===c){var p=Ye(i,o,s,a);p[0]>0&&l.push("v".concat(p[0])),l.push("l".concat(r," ").concat(a,"l").concat(0-r," ").concat(a)),p[1]>0&&l.push("v".concat(p[1]))}else l.push("v".concat(i-2*o));if(l.push("a".concat(o," ").concat(o," 0 0 1 ").concat(0-o," ").concat(o)),"bottom"===c){var d=Ye(n,o,s,a);d[1]>0&&l.push("h".concat(0-d[1])),l.push("l".concat(0-a," ").concat(r,"l").concat(0-a," ").concat(0-r)),d[0]>0&&l.push("h".concat(0-d[0]))}else l.push("h".concat(0-n+2*o));if(l.push("a".concat(o," ").concat(o," 0 0 1 ").concat(0-o," ").concat(0-o)),"left"===c){var h=Ye(i,o,s,a);h[1]>0&&l.push("v".concat(0-h[1])),l.push("l".concat(0-r," ").concat(0-a,"l").concat(r," ").concat(0-a)),h[0]>0&&l.push("v".concat(0-h[0]))}else l.push("v".concat(0-i+2*o));return l.push("a".concat(o," ").concat(o," 0 0 1 ").concat(o," ").concat(0-o,"z")),l.join("")}
/**
                           * @author season <season-studio@outlook.com>
                           * @license Apache-2.0
                           */(a,s,c,l,Number(r.cornerRadius)||7,Number(r.raiseHeight)||10,Number(r.raiseBase)||10,Number(r.raiseOffset)||0,r.raiseEdge)),e.setAttribute("style",kt)),e},rectBackground:function(e,t,n,i,o,r){var a=t.left,s=t.top,c=t.width,l=t.height;return e instanceof SVGRectElement||(e&&e.remove(),e=document.createElementNS("http://www.w3.org/2000/svg","rect")),e&&(e.setAttribute("style",kt),e.setAttribute("rx",Number(r&&r.cornerRadius)||7),e.setAttribute("x",a),e.setAttribute("y",s),e.setAttribute("width",c),e.setAttribute("height",l)),e}})});var Et={rootAttrs:{"mmap-layout":"line","mmap-layout-margin":"0","mmap-layout-padding":"5","mmap-layout-background":"generateBackground","mmap-bind-cancel-edit":"","mmap-bind-hide-in-render":"relayout","mmap-bind-filter-edit":"href"},singletonStamp:"topic-href-editor",onInitialize:function(e){var t=this.inputNode=this.rootNode.querySelector(".season-topic-href-editor");t&&e.topic instanceof Ne&&(t.value=e.topic.data.href||"",t.select())},generateBackground:function(){var e;return(e=wt.backgroundGenerator).dialogBubbleBackground.apply(e,Array.prototype.slice.call(arguments).concat([{}]))},onAfterLayout:function(e){var t=this.rootNode.getBBox(),n=e.topic.getGraphicRect();this.rootNode.setAttribute("transform","translate(".concat(n.x+(n.width-t.width)/2,", ").concat(n.y+n.height+11,")")),Ne.showNodeInSvgView(this.rootNode,this.rootNode.ownerSVGElement),this.inputNode.focus()},browser:function(e,t,n,i){var o=this;return D(R.mark((function e(){var t,i;return R.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,xt();case 3:(t=e.sent)instanceof Blob&&(i={name:t.name,resource:t},n.env.fireEvent("topic-event-update-attachment",i),i.href&&(o.inputNode.value=i.href),o.close()),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),n.env.warn("Fail in pickup file as the attachment of the topic",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},delete:function(e,t,n,i){this.inputNode.value="",this.close()},onClose:function(e){var t=e.topic;if(t instanceof Ne){var n=String(this.inputNode.value).trim();n!==t.data.href&&(t.changeData("href",n||void 0),t.queueAction((function(){return t.render()})))}}};function At(e){return Lt.apply(this,arguments)}function Lt(){return(Lt=D(R.mark((function e(t){var n,i,o;return R.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,xt(".jpg,.jpeg,.png,.gif,.ico,.bmp,.svg");case 2:(n=e.sent)instanceof Blob&&(i={name:(t.env.config.defaultResourceAttachmentPrefix||"")+n.name,resource:n},t.env.fireEvent("topic-event-update-attachment",i),i.href&&((o=t.data.image)?t.changeData("image",{href:i.href,width:o.width,height:o.height}):t.changeData("image",{href:i.href}),t.queueAction((function(){return t.render()}))));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function St(){return(St=D(R.mark((function e(t){var n;return R.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return V((n=t.eventTarget)instanceof Ne,M,-1,"Cannot invoke the image edit action without an instance of Topic"),e.next=4,At(n);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Nt(e,t){if(e&&t instanceof Node){var n=document.createElementNS("http://www.w3.org/2000/svg","g");n.setAttribute("class","season-topic-label-edit-item"),n.setAttribute("d-label",e),n.innerHTML="<text>".concat(e,"</text>"),t.appendChild(n);var i=n.getBBox(),o=i.width,r=i.height;n.insertAdjacentHTML("afterbegin",'<rect x="0" y="0" width="'.concat(o+r,'" height="').concat(r,'" />')),n.insertAdjacentHTML("beforeend",'<g class="season-topic-label-edit-delete" transform="translate('.concat(o,',0)" mmap-event-click="delete">\n            <rect x="0" y="0"  width="').concat(r,'" height="').concat(r,'" />\n            <use href="#season-topic-predefine-image-cross" width="').concat(r,'" height="').concat(r,'" />\n        </g>'))}}var Tt={rootAttrs:{"mmap-layout":"row","mmap-layout-margin":"5","mmap-layout-padding":"10","mmap-layout-background":"generateBackground","mmap-bind-cancel-edit":"","mmap-bind-hide-in-render":"relayout","mmap-bind-filter-edit":"labels"},singletonStamp:"topic-labels-editor",onInitialize:function(e){var t=e.topic instanceof Ne&&e.topic.data.labels;t=Array.from(t instanceof Array?t:[]),this.labels=t;var n=this.rootNode.querySelector(".season-topic-labels-edit-list");t.forEach((function(e){return Nt(e,n)}))},generateBackground:function(){var e;return(e=wt.backgroundGenerator).dialogBubbleBackground.apply(e,Array.prototype.slice.call(arguments).concat([{}]))},onAfterLayout:function(e){var t=this.rootNode.getBBox(),n=e.topic.getGraphicRect();this.rootNode.setAttribute("transform","translate(".concat(n.x+(n.width-t.width)/2,", ").concat(n.y+n.height+11,")")),Ne.showNodeInSvgView(this.rootNode,this.rootNode.ownerSVGElement)},onInputKeydown:function(e,t,n){var i=e.target;if(i){var o=String(e.key).toLowerCase();if("enter"===o){o=void 0;var r=String(i.value).trim();this.labels.includes(r)||(i.value="",this.labels.push(r),Nt(r,this.rootNode.querySelector(".season-topic-labels-edit-list")),this.relayout())}else"tab"===o?o=void 0:"escape"===o&&(o=void 0,i.value="");o||(e.preventDefault(),e.stopPropagation())}},onClose:function(e){var t=e.topic;if(t instanceof Ne){var n=this.labels;String(n)!==String(t.data.labels)&&(t.changeData("labels",n.length>0?n:void 0),t.queueAction((function(){return t.render()})))}},delete:function(e,t,n){for(;t&&!t.hasAttribute("d-label");)(t=t.parentNode)===this.rootNode&&(t=void 0);if(t&&this.labels){var i=t.getAttribute("d-label"),o=this.labels.indexOf(i);o>=0&&this.labels.splice(o,1),t.remove(),this.relayout()}}};var Ct="<p><br /></p>";var Mt=[{key:"bold",tag:"b"},{key:"underline",tag:"u"},{key:"italic",tag:"i"},{key:"code",tag:"code"},{key:"color",tag:"span",formatter:function(e){return' style="color:'.concat(e.color,';"')}}],Bt={"<":"&lt;",">":"&gt;"};function Dt(e){return Bt[e]||"&nbsp;"}var zt={bullet:{prefix:"<ul>",tag:"li",suffix:"</ul>"},ordered:{prefix:"<ol>",tag:"li",suffix:"</ol>"}};function qt(e,t){var n,i=[],o=[];i.push(o),t.ops instanceof Array&&t.ops.forEach((function(e){if(e){var t=e.attributes;String(e.insert||"").split("\n").forEach((function(e,n){var r,a,s,c;n>0&&(o.$type=t&&t.list,i.push(o=[])),e&&(r=o,a=e,(s=t)&&(c=[],Mt.forEach((function(e){if(s[e.key]){var t=e.tag,n=e.class,i=e.style,o=e.formatter;r.push("<".concat(t).concat(n?' class="'.concat(n,'"'):"").concat(i?' style="'.concat(i,'"'):"").concat(o?o(s):"",">")),c.unshift("</".concat(t,">"))}}))),r.push(a.replace(/[\s<>]/gi,Dt)),c&&c.length>0&&r.push.apply(r,c))}))}})),0===o.length&&i.pop(),e.innerHTML=i.map((function(e){var t=zt[e.$type],i=[];return t!==n&&(n&&i.push(n.suffix),t&&i.push(t.prefix)),n=t,i.push("<".concat(t?t.tag:"p",">")),i.push(e.join("")||"<br />"),i.push("</".concat(t?t.tag:"p",">")),i.join("")})).join("")||Ct}var $t=[{key:"fo:font-weight",value:"bold",tag:"b"},{key:"fo:font-style",value:"italic",tag:"i"},{key:"fo:text-decoration",value:"underline",tag:"u"}];function It(e,t){var n=[];t.paragraphs instanceof Array&&t.paragraphs.forEach((function(e){n.push("<p>"),e.spans instanceof Array&&e.spans.forEach((function(e){return function(e,t){if(t.text){var n,i=t.style&&t.style.properties;i&&(n=[],$t.forEach((function(t){if(i[t.key]===t.value){var o=t.tag,r=t.class,a=t.style;e.push("<".concat(o).concat(r?' class="'.concat(r,'"'):"").concat(a?' style="'.concat(a,'"'):"",">")),n.unshift("</".concat(o,">"))}}))),e.push(t.text.replace(/\s/gi,"&nbsp;")),n&&n.length>0&&e.push.apply(e,n)}else e.push("<br />")}(n,e)})),n.push("</p>")})),e.innerHTML=n.join("")||Ct}function Rt(e,t){e instanceof Node&&(t.ops?qt(e,t.ops):t.html&&t.html.content?It(e,t.html.content):t.plain?function(e,t){e.innerHTML=t.content?"<p>".concat(String(t.content).split("\n").map((function(e){return e.replace(/\s/gi,"&nbsp;")})).join("</p><p>"),"</p>"):Ct}(e,t.plain):e.innerHTML=Ct)}function Vt(e,t,n,i){var o=t||[];return e&&(e.normalize(),e.childNodes.forEach((function(t){if(t instanceof HTMLBRElement)e.childElementCount>1&&o.push(n=[]);else if(t.nodeType===Node.TEXT_NODE)n||o.push(n=[]),n.push({attr:i,text:t.textContent});else{if(t.childNodes.length<=0)return;if(t instanceof HTMLParagraphElement)o.push(n=[]),n=Vt(t,o,n,i).paragraph;else if(t instanceof HTMLLIElement)o.push(n=[]),n.$type=e instanceof HTMLUListElement?"bullet":"ordered",Vt(t,o,n,i).paragraph,n=void 0;else if(t instanceof HTMLUListElement||t instanceof HTMLOListElement)n=Vt(t,o,void 0,i).paragraph;else if(t instanceof HTMLSpanElement){var r=Object.assign({},i),a=t.style;a.color&&(r.color=a.color),n=Vt(t,o,n,r).paragraph}else if(t instanceof HTMLElement){var s=String(t.nodeName).toLowerCase();if("code"===s){var c=Object.assign({},i);c.code=!0,n=Vt(t,o,n,c).paragraph}else if("b"===s){var l=Object.assign({},i);l.bold=!0,n=Vt(t,o,n,l).paragraph}else if("i"===s){var u=Object.assign({},i);u.italic=!0,n=Vt(t,o,n,u).paragraph}else if("u"===s){var p=Object.assign({},i);p.underline=!0,n=Vt(t,o,n,p).paragraph}else n=Vt(t,o,n,Object.assign({},i)).paragraph}}}))),{paragraphSet:o,paragraph:n}}function Gt(e){var t=[];return e.forEach((function(e){var n=[];t.push({spans:n}),e instanceof Array&&e.forEach((function(e){if(e.attr){var t={},i={type:"text",properties:t};e.attr.bold&&(t["fo:font-weight"]="bold"),e.attr.italic&&(t["fo:font-style"]="italic"),e.attr.underline&&(t["fo:text-decoration"]="underline"),n.push({style:i,text:e.text})}else n.push({text:e.text})}))})),t}function Pt(e){var t,n,i,o=Vt(e).paragraphSet;return{plain:{content:e.textContent},ops:{ops:(t=o,n=[],i=[],t.forEach((function(e){e instanceof Array&&(e.forEach((function(e){e.attr?(i.length>0&&n.push({insert:i.join("")}),i=[],n.push({attributes:e.attr,insert:e.text||""})):i.push(e.text||"")})),e.$type?(i.length>0&&n.push({insert:i.join("")}),i=[],n.push({attributes:{list:e.$type},insert:"\n"})):i.push("\n"))})),i.length>0&&n.push({insert:i.join("")}),n)},html:{content:{paragraphs:Gt(o)}}}}var Ot=Symbol("season.topic.notes.normalize");var jt={p:"p",b:"b",u:"u",i:"i",ul:"ul",ol:"ol",li:"li",br:"br",h1:"p",h2:"p",h3:"p",h4:"p",h5:"p",h6:"p",div:"p",code:"code"};function Ht(e){if(!(e instanceof Node)||e[Ot])return e;switch(e.nodeType){case Node.ELEMENT_NODE:e.normalize();var t,n=jt[String(e.nodeName).toLocaleLowerCase()];return t="string"==typeof n?document.createElementNS(e.namespaceURI,n):"function"==typeof n?n(e):function(e){var t;if(e.getAttribute("style")){var n=e.style.color;n?(t=document.createElement("span"),n&&(t.style.color=n)):e.childElementCount&&(t=document.createElement("span"))}else e.childElementCount&&(t=document.createElement("span"));return t||document.createTextNode(e.textContent)}(e),t&&(t[Ot]=!0,t instanceof Element&&e.childNodes.forEach((function(e){(e=Ht(e))&&t.appendChild(e)}))),t.normalize(),(t.childNodes.length>0||t instanceof HTMLBRElement||t.nodeType===Node.TEXT_NODE)&&t;case Node.TEXT_NODE:var i=e.cloneNode(!0);return i[Ot]=!0,i;default:return null}}function Ft(e){try{var t=e.clipboardData||window.clipboardData;if(t){var n=t.getData("text/html");if(n){var i=(new DOMParser).parseFromString(n,"text/html");if(i&&!i.querySelector("parsererror")){var o=[];i.body.childNodes.forEach((function(e){var t=Ht(e);t instanceof Node&&o.push(t.nodeType===Node.TEXT_NODE?t.wholeText:t.outerHTML)})),document.execCommand("insertHTML",!1,o.join(""))}e.preventDefault()}}}catch(t){e.preventDefault(),console.warn("Fail in filte the paste content for the note's editor. The action is cancelled.",t)}}var _t={rootAttrs:{"mmap-layout":"row","mmap-layout-margin":"5","mmap-layout-padding":"10","mmap-layout-background":"generateBackground","mmap-bind-cancel-edit":"","mmap-bind-hide-in-render":"relayout","mmap-bind-filter-edit":"notes"},singletonStamp:"topic-notes-shower",onInitialize:function(e){var t=this.editorNode=this.rootNode.querySelector(".season-topic-notes-editor-box");t&&(t.addEventListener("paste",this.onPaste=Ft.bind(this)),e.topic instanceof Ne&&Rt(t,e.topic.data.notes))},generateBackground:function(){var e;return(e=wt.backgroundGenerator).dialogBubbleBackground.apply(e,Array.prototype.slice.call(arguments).concat([{}]))},onAfterLayout:function(e){var t=this.rootNode.getBBox(),n=e.topic.getGraphicRect();this.rootNode.setAttribute("transform","translate(".concat(n.x+(n.width-t.width)/2,", ").concat(n.y+n.height+11,")")),Ne.showNodeInSvgView(this.rootNode,this.rootNode.ownerSVGElement)},setBold:function(e,t,n){document.execCommand("bold",!1)},setItalic:function(e,t,n){document.execCommand("italic",!1)},setUnderline:function(e,t,n){document.execCommand("underline",!1)},setUnorderList:function(e,t,n){document.execCommand("insertUnorderedList",!1)},setOrderList:function(e,t,n){document.execCommand("insertOrderedList",!1)},delete:function(e,t,n){this.editorNode&&(this.editorNode.innerHTML=Ct),this.close()},onClose:function(e){if(this.editorNode){this.editorNode.removeEventListener("paste",this.onPaste);var t=Pt(this.editorNode);t&&!String(t.plain.content).trim()&&(t=void 0);var n=e.topic;if(n instanceof Ne){var i=n.data.notes;n.changeData("notes",t),(i&&!0)^(t&&!0)&&n.queueAction((function(){return n.render()}))}}}};function Wt(e){var t=e.eventTarget;t instanceof Ne&&wt(t.$assignedNode.ownerSVGElement,'\n<style>\n    .season-topic-notes-editor-button > rect {\n        width: 20px;\n        height: 20px;\n        x: 0px;\n        y: 0px;\n        rx: 5px;\n        ry: 5px;\n        fill: rgba(255,255,255,0.1);\n        stroke: none;\n    }\n    .season-topic-notes-editor-button > use {\n        fill: #000;\n        stroke: none;\n    }\n    .season-topic-notes-editor-button > path {\n        fill: #000;\n        stroke: none;\n    }\n    .season-topic-notes-editor-button:hover > use {\n        fill: var(--topic-ui-hover-front-color);\n        stroke: none;\n    }\n    .season-topic-notes-editor-button:hover > path {\n        fill: var(--topic-ui-hover-front-color);\n        stroke: none;\n    }\n    .season-topic-notes-editor-button:hover > rect {\n        fill: var(--topic-ui-hover-back-color);\n    }\n    .season-topic-notes-editor-delete:hover > rect {\n        fill: var(--topic-ui-danger-color);\n    }\n    .season-topic-notes-editor-toolbar > g > rect {\n        rx: 5px;\n        ry: 5px;\n        width: 20px;\n        height: 20px;\n        x: 0px;\n        y: 0px;\n    }\n</style>\n<g mmap-layout="line" mmap-layout-margin="5" mmap-layout-padding="0" class="season-topic-notes-editor-toolbar">\n    <g class="season-topic-svg-button" mmap-event-click="setBold">\n        <rect />\n        <use href="#season-topic-predefine-image-bold" width="20" height="20" />\n    </g>\n    <g class="season-topic-svg-button" mmap-event-click="setItalic">\n        <rect />\n        <use href="#season-topic-predefine-image-italic" width="20" height="20" />\n    </g>\n    <g class="season-topic-svg-button" mmap-event-click="setUnderline">\n        <rect />\n        <use href="#season-topic-predefine-image-underline" width="20" height="20" />\n    </g>\n    <g class="season-topic-svg-button" mmap-event-click="setUnorderList">\n        <rect />\n        <use href="#season-topic-predefine-image-unorder-list" width="20" height="20" />\n    </g>\n    <g class="season-topic-svg-button" mmap-event-click="setOrderList">\n        <rect />\n        <use href="#season-topic-predefine-image-order-list" width="20" height="20" />\n    </g>\n    <rect width="60" height="20" fill="rgba(255,255,255,0.05)" stroke="none" />\n    <g class="season-topic-svg-button" d-svg-button-danger="" mmap-event-click="delete">\n        <rect />\n        <use href="#season-topic-predefine-image-delete" width="20" height="20" />\n    </g>\n</g>\n<foreignObject width="210" height="170">\n    <style>\n        .season-topic-notes-editor-box {\n            overflow: scroll;\n            border: 1px solid #666;\n            box-sizing: border-box;\n            width: 100%;\n            height: 100%;\n            outline: none;\n            font-size: 12px;\n            word-break: break-all;\n        }\n        .season-topic-notes-editor-box p {\n            margin: 0px;\n        }\n        .season-topic-notes-editor-box ul,.season-topic-notes-editor-box ol {\n            margin: 0px;\n            padding-left: 2em;\n        }\n        .season-topic-notes-editor-box code {\n            background-color: #ddd;\n            color: darkorange;\n        }\n    </style>\n    <div class="season-topic-notes-editor-box" contenteditable="true">\n        <p><br /></p>\n    </div>\n</foreignObject>\n',Object.assign({topic:t,env:t.env,singletonMutex:t.id},_t))}var Ut={rootAttrs:{"mmap-layout":"row","mmap-layout-margin":"5","mmap-layout-padding":"5","mmap-layout-background":"generateBackground","mmap-bind-cancel-edit":"","mmap-bind-hide-in-render":"relayout","mmap-bind-filter-edit":"priority"},singletonStamp:"topic-priority-editor",onInitialize:function(e){var t=this.rootNode.querySelector('g[d-priority-value="'.concat(e.topic.data.priority,'"]'));t&&t.setAttribute("d-priority-selected","")},generateBackground:function(){var e;return(e=wt.backgroundGenerator).dialogBubbleBackground.apply(e,Array.prototype.slice.call(arguments).concat([{}]))},onAfterLayout:function(e){var t=this.rootNode.getBBox(),n=e.topic.getGraphicRect();this.rootNode.setAttribute("transform","translate(".concat(n.x+(n.width-t.width)/2,", ").concat(n.y+n.height+11,")")),Ne.showNodeInSvgView(this.rootNode,this.rootNode.ownerSVGElement)},selectPriority:function(e,t,n,i){var o=Number(t.getAttribute("d-priority-value"))||0;n.topic&&o!==n.topic.data.priority&&(n.topic.changeData("priority",o),n.topic.queueAction((function(){return n.topic.render()}))),this.close()},deletePriority:function(e,t,n,i){n.topic&&(n.topic.changeData("priority"),n.topic.queueAction((function(){return n.topic.render()}))),this.close()}};var Xt={rootAttrs:{"mmap-layout":"row","mmap-layout-margin":"5","mmap-layout-padding":"5","mmap-layout-background":"generateBackground","mmap-bind-cancel-edit":"","mmap-bind-hide-in-render":"relayout","mmap-bind-filter-edit":"task-marker"},singletonStamp:"topic-task-marker-editor",onInitialize:function(e){if(void 0!==e.topic.data["task-marker"]){var t=Number(e.topic.data["task-marker"]),n=this.rootNode.querySelector('g[d-task-marker-value="'.concat(t>=0&&t<=8?t:"unknown",'"]'));n&&n.setAttribute("d-task-marker-selected","")}},generateBackground:function(){var e;return(e=wt.backgroundGenerator).dialogBubbleBackground.apply(e,Array.prototype.slice.call(arguments).concat([{}]))},onAfterLayout:function(e){var t=this.rootNode.getBBox(),n=e.topic.getGraphicRect();this.rootNode.setAttribute("transform","translate(".concat(n.x+(n.width-t.width)/2,", ").concat(n.y+n.height+11,")")),Ne.showNodeInSvgView(this.rootNode,this.rootNode.ownerSVGElement)},selectTaskMarker:function(e,t,n,i){var o=Number(t.getAttribute("d-task-marker-value"));isNaN(o)&&(o="unknown"),n.topic&&o!==n.topic.data["task-marker"]&&(n.topic.changeData("task-marker",o),n.topic.queueAction((function(){return n.topic.render()}))),this.close()},deleteTaskMarker:function(e,t,n,i){n.topic&&(n.topic.changeData("task-marker"),n.topic.queueAction((function(){return n.topic.render()}))),this.close()}};var Yt={rootAttrs:{"mmap-bind-cancel-edit":"","mmap-bind-hide-in-render":"relayout","mmap-bind-filter-edit":"title"},singletonStamp:"topic-title-editor",onInitialize:function(e){this.mainNode=this.rootNode.querySelector("foreignObject"),this.inputNode=this.rootNode.querySelector(".season-topic-title-editor"),this.topic=e.topic,this.onSubmit=function(){var e=this,t=String(this.inputNode.value).trim();t!==this.topic.data.title&&(this.topic.changeData("title",t),this.topic.queueAction((function(){return e.topic.render()})))}.bind(this),this.onBlur=function(){this.onSubmit(),this.close()}.bind(this),this.inputNode.addEventListener("blur",this.onBlur)},onAfterLayout:function(e){var t=this.topic.env.config,n=Number(t.secondaryPadding)||5;this.inputNode.value=String(this.topic.data.title||"").trim(),this.inputNode.style.padding=this.inputNode.style.borderRadius="".concat(n,"px");var i=this.topic.getGraphicRect(),o=this.topic.getGraphicRect(".season-topic-title"),r=this.topic.$assignedNode.querySelector(".season-topic-image")?o.y-i.y-n:1,a=i.height-r-1;this.mainNode.setAttribute("x",1),this.mainNode.setAttribute("y",r),this.mainNode.setAttribute("width",i.width-2),this.mainNode.setAttribute("height",a);var s=this.topic.$assignedNode.querySelector(":scope > [season-topic-content-group] > .season-topic-title"),c=getComputedStyle(s);c&&(this.inputNode.style.fontSize=c["font-size"],this.inputNode.style.fontWeight=c["font-weight"]),this.inputNode.focus(),this.inputNode.select()},onKeydown:function(e,t,n){var i=String(e.key).toLowerCase();"enter"===i?(i=void 0,this.onSubmit(),this.close()):"tab"===i?i=void 0:"escape"===i&&(i=void 0,this.close()),i||(e.preventDefault(),e.stopPropagation())},onClose:function(){this.inputNode.removeEventListener("blur",this.onBlur)}};
/**
                           * @author season <season-studio@outlook.com>
                           * @license Apache-2.0
                           */
var Kt={title:{edit:function(e){var t=e.eventTarget;t instanceof Ne&&wt(t.$assignedNode,'\n    <foreignObject>\n        <style>\n            .season-topic-title-editor {\n                outline: none;\n                border: 1px solid #777;\n                box-sizing: border-box;\n                width: 100%;\n                height: 100%;\n                color: #000;\n                background-color: #fff;\n            }\n        </style>\n        <input xmlns="http://www.w3.org/1999/xhtml" class="season-topic-title-editor" tabindex="0" mmap-event-keydown="onKeydown"></input>\n    </foreignObject>\n',Object.assign({topic:t,env:t.env},Yt))}},image:{edit:function(e){return St.apply(this,arguments)},trigger:function(e){return new Promise((function(t,n){try{var i=e.eventTarget;if(i instanceof Ne){var o=i.$assignedNode.ownerSVGElement.querySelector("foreignObject[season-topic-image-trigger]");o||(o=document.createElementNS("http://www.w3.org/2000/svg","foreignObject"));var r=i.$assignedNode.ownerSVGElement.querySelector("foreignObject[season-topic-image-trigger-toolbar]");if(r||(r=document.createElementNS("http://www.w3.org/2000/svg","g")),o&&r)return function(e,t,n){var i=e.$assignedNode.querySelector(":scope > [season-topic-content-group] > .season-topic-image");if(e.data.image&&i){var o=function(){var i=e.getGraphicRect(),o=e.getGraphicRect(".season-topic-image");y=o.width,b=o.height,w=o.x-i.x-g,k=o.y-i.y-g,t.setAttribute("x",w),t.setAttribute("y",k),t.setAttribute("width",y+2*g),t.setAttribute("height",b+2*g),n.setAttribute("transform","translate(".concat(i.width-g-48,", -26)"))},r=function(){x&&(x=void 0,o())},a=function(){var t=D(R.mark((function t(n){return R.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:At(e),n.preventDefault(),n.stopPropagation();case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),s=function(t){e.changeData("image"),e.queueAction((function(){return e.render()})),h(),t.preventDefault(),t.stopPropagation()},c=function(e){if(0!=(1&e.buttons)){if(x){var n=t.ownerSVGElement.getCTM().inverse().translate(e.clientX,e.clientY),i=n.e,o=n.f;y=x.oriWidth+(i-=x.startX)*x.dx,b=x.oriHeight+(o-=x.startY)*x.dy,x.dx<0&&(w=x.oriX+i),x.dy<0&&(k=x.oriY+o),y<0&&(x.dx<0&&(w+=y),y=0),b<0&&(x.dy<0&&(k+=b),b=0),t.setAttribute("x",w),t.setAttribute("y",k),t.setAttribute("width",y+2*g),t.setAttribute("height",b+2*g)}}else r()},l=function(e){for(var n in E)if(e.target.matches(n)){var i=E[n],o=i.dx,r=i.dy,a=t.ownerSVGElement.getCTM().inverse().translate(e.clientX,e.clientY);x={dx:o,dy:r,startX:a.e,startY:a.f,oriWidth:y,oriHeight:b,oriX:w,oriY:k},e.preventDefault(),e.stopPropagation();break}},u=function(t){if(0==(1&t.buttons)&&x){if(y>0&&b>0){var n=e.data.image;n&&e.changeData("image",{href:n.href,width:y,height:b}),e.queueAction((function(){return e.render().queueAction(o)}))}x=void 0,t.preventDefault(),t.stopPropagation()}},p=function(e){e.preventDefault(),e.stopPropagation()},d=function(e){"escape"===String(e.key).toLowerCase()&&r()},h=function(){e.notify("topic-event-image-trigger-clear"),t.remove(),n.remove()},f=function(e){var t=e.detail;t&&"image"!==t.triggerContentType&&h()},v=function i(){t.removeEventListener("mousedown",l),t.removeEventListener("click",p),t.removeEventListener("dblclick",a),t.ownerSVGElement.removeEventListener("mousemove",c),t.ownerSVGElement.removeEventListener("mouseup",u),t.ownerSVGElement.removeEventListener("keydown",d),e.env.removeEventListener("topic-event-cancel-edit",h),e.env.removeEventListener("topic-event-trigger",f),e.env.removeEventListener("topic-event-image-trigger-clear",i);var o=n.querySelector('[d-btn-action="browser"]');o&&o.removeEventListener("click",a),(o=n.querySelector('[d-btn-action="delete"]'))&&o.removeEventListener("click",s)},g=e.env.config.padding,m=e.env.config.secondaryPadding,y=0,b=0,w=0,k=0,x=null;t.setAttribute("style","--padding:".concat(g,"px;--secondary-padding:").concat(m,"px;")),t.setAttribute("class","season-topic-image-trigger"),t.setAttribute("season-topic-image-trigger",""),t.innerHTML="",e.$assignedNode.appendChild(t),t.insertAdjacentHTML("afterbegin",'\n<style>\n    .season-topic-image-trigger {\n        position: relative;\n    }\n    .season-topic-image-size-box {\n        box-sizing: border-box;\n        position: absolute;\n        top: var(--padding);\n        left: var(--padding);\n        right: var(--padding);\n        bottom: var(--padding);\n        border: 1px dashed #666;\n        background: none;\n    }\n    .season-topic-image-size-corner {\n        box-sizing: border-box;\n        position: absolute;\n        --corner-size: calc((var(--padding) + 1px) / 2);\n        border: var(--corner-size) solid rgba(0,0,0,0.3);\n        width: calc(var(--corner-size) + var(--corner-size));\n        height: calc(var(--corner-size) + var(--corner-size));\n    }\n    .season-topic-image-size-corner:hover {\n        border-color: rgba(0,0,0,0.6);\n    }\n    .season-topic-image-size-corner-lefttop {\n        border-right: none;\n        border-bottom: none;\n        top: calc(0px - var(--corner-size));\n        left: calc(0px - var(--corner-size));\n        cursor: nwse-resize;\n    }\n    .season-topic-image-size-corner-leftbottom {\n        border-right: none;\n        border-top: none;\n        bottom: calc(0px - var(--corner-size));\n        left: calc(0px - var(--corner-size));\n        cursor: nesw-resize;\n    }\n    .season-topic-image-size-corner-righttop {\n        border-left: none;\n        border-bottom: none;\n        top: calc(0px - var(--corner-size));\n        right: calc(0px - var(--corner-size));\n        cursor: nesw-resize;\n    }\n    .season-topic-image-size-corner-rightbottom {\n        border-left: none;\n        border-top: none;\n        bottom: calc(0px - var(--corner-size));\n        right: calc(0px - var(--corner-size));\n        cursor: nwse-resize;\n    }\n</style>\n<div class="season-topic-image-size-box">\n    <div class="season-topic-image-size-corner season-topic-image-size-corner-lefttop"></div>\n    <div class="season-topic-image-size-corner season-topic-image-size-corner-leftbottom"></div>\n    <div class="season-topic-image-size-corner season-topic-image-size-corner-righttop"></div>\n    <div class="season-topic-image-size-corner season-topic-image-size-corner-rightbottom"></div>\n</div>\n'),e.$assignedNode.appendChild(n),n.insertAdjacentHTML("afterbegin",'\n<style>\n    .season-topic-image-trigger-toolbutton > rect {\n        rx: 6px;\n        ry: 6px;\n        width: 24px;\n        height: 24px;\n    }\n</style>\n<g class="season-topic-svg-3d-button season-topic-image-trigger-toolbutton" d-btn-action="browser">\n    <rect />\n    <use x="1" width="22" height="22" href="#season-topic-predefine-image-picture" />\n</g>\n<g class="season-topic-svg-3d-button season-topic-image-trigger-toolbutton" d-svg-button-danger="" d-btn-action="delete" transform="translate(26, 0)">\n    <rect />\n    <use x="1" width="22" height="22" href="#season-topic-predefine-image-delete" />\n</g>\n');var E={".season-topic-image-size-corner-rightbottom":{dx:1,dy:1},".season-topic-image-size-corner-righttop":{dx:1,dy:-1},".season-topic-image-size-corner-lefttop":{dx:-1,dy:-1},".season-topic-image-size-corner-leftbottom":{dx:-1,dy:1}};!function(){e.notify("topic-event-image-trigger-clear"),o(),t.addEventListener("mousedown",l),t.addEventListener("click",p),t.addEventListener("dblclick",a),t.ownerSVGElement.addEventListener("mousemove",c),t.ownerSVGElement.addEventListener("mouseup",u),t.ownerSVGElement.addEventListener("keydown",d),e.env.addEventListener("topic-event-cancel-edit",h,{once:!0}),e.env.addEventListener("topic-event-trigger",f,{once:!0}),e.env.addEventListener("topic-event-image-trigger-clear",v,{once:!0});var i=n.querySelector('[d-btn-action="browser"]');i&&i.addEventListener("click",a),(i=n.querySelector('[d-btn-action="delete"]'))&&i.addEventListener("click",s)}()}else t.remove()}(i,o,r),void t()}n(M(-1,"cannot setup the trigger"))}catch(e){n(e)}}))}},priority:{edit:function(e){var t=e.eventTarget;t instanceof Ne&&wt(t.$assignedNode.ownerSVGElement,'\n<style>\n    .topic-priority-edit-item > rect {\n        width: 20px;\n        height: 20px; \n        x: 0; \n        y: 0;\n        rx: 5px;\n        ry: 5px;\n    }\n    .topic-priority-edit-item[d-priority-selected] > rect {\n        fill: var(--topic-ui-focus-color);\n        stroke: var(--topic-ui-focus-border-color);\n        stroke-width: 1px;\n        stroke-dasharray: 2;\n    }\n    .topic-priority-placeholder {\n        fill: none;\n        stroke: none;\n        width: 20px;\n        height: 20px;\n        x: 0; \n        y: 0;\n        rx: 5px;\n        ry: 5px;\n    }\n</style>\n<g mmap-layout="line">\n    <g class="topic-priority-edit-item season-topic-svg-button" mmap-event-click="selectPriority" d-priority-value="1">\n        <rect />\n        <use href="#topic-priority-1" />\n    </g>\n    <g class="topic-priority-edit-item season-topic-svg-button" mmap-event-click="selectPriority" d-priority-value="2">\n        <rect />\n        <use href="#topic-priority-2" />\n    </g>\n    <g class="topic-priority-edit-item season-topic-svg-button" mmap-event-click="selectPriority" d-priority-value="3">\n        <rect />\n        <use href="#topic-priority-3" />\n    </g>\n    <g class="topic-priority-edit-item season-topic-svg-button" mmap-event-click="selectPriority" d-priority-value="4">\n        <rect />\n        <use href="#topic-priority-4" />\n    </g>\n</g>\n<g mmap-layout="line">\n    <g class="topic-priority-edit-item season-topic-svg-button" mmap-event-click="selectPriority" d-priority-value="5">\n        <rect />\n        <use href="#topic-priority-5" />\n    </g>\n    <g class="topic-priority-edit-item season-topic-svg-button" mmap-event-click="selectPriority" d-priority-value="6">\n        <rect />\n        <use href="#topic-priority-6" />\n    </g>\n    <g class="topic-priority-edit-item season-topic-svg-button" mmap-event-click="selectPriority" d-priority-value="7">\n        <rect />\n        <use href="#topic-priority-7" />\n    </g>\n    <g class="topic-priority-edit-item season-topic-svg-button" mmap-event-click="selectPriority" d-priority-value="8">\n        <rect />\n        <use href="#topic-priority-8" />\n    </g>\n</g>\n<g mmap-layout="line">\n    <g class="topic-priority-edit-item season-topic-svg-button" mmap-event-click="selectPriority" d-priority-value="9">\n        <rect />\n        <use href="#topic-priority-9" />\n    </g>\n    <rect class="topic-priority-placeholder" />\n    <rect class="topic-priority-placeholder" />\n    <g class="topic-priority-edit-item season-topic-svg-button" d-svg-button-danger="" mmap-event-click="deletePriority">\n        <rect />\n        <use href="#season-topic-predefine-image-delete" width="20" height="20" />\n    </g>\n</g>\n',Object.assign({topic:t,env:t.env,singletonMutex:t.id},Ut))}},href:{edit:function(e){var t=e.eventTarget;t instanceof Ne&&wt(t.$assignedNode.ownerSVGElement,'\n<style>\n    .topic-href-edit-button > rect {\n        x: 0;\n        y: 0;\n        rx: 5px;\n        ry: 5px;\n        width: 26px;\n        height: 26px;\n    }\n</style>\n<foreignObject width="100" height="26" style="padding:0px 5px 0px 0px;">\n    <style>\n        .season-topic-href-editor {\n            outline: none;\n            border: 1px solid #777;\n            box-sizing: border-box;\n            width: 100%;\n            height: 100%;\n            color: #000;\n            background-color: #fff;\n            font-size: 12px;\n        }\n    </style>\n    <input xmlns="http://www.w3.org/1999/xhtml" class="season-topic-href-editor" tabindex="0"></input>\n</foreignObject>\n<g class="season-topic-svg-button topic-href-edit-button" mmap-event-click="browser">\n    <rect />\n    <use href="#season-topic-predefine-image-open" width="26" height="26" />\n</g>\n<g class="season-topic-svg-button topic-href-edit-button" d-svg-button-danger="" mmap-event-click="delete">\n    <rect />\n    <use href="#season-topic-predefine-image-delete" width="26" height="26" />\n</g>\n',Object.assign({topic:t,env:t.env,singletonMutex:t.id},Et))},trigger:function(e){var t=e.eventTarget;t instanceof Ne&&t.env.activeLink(t.env.translateHRefToURL(t.data.href))}},"task-marker":{edit:function(e){var t=e.eventTarget;t instanceof Ne&&wt(t.$assignedNode.ownerSVGElement,'\n<style>\n    .topic-task-marker-item > rect {\n        width: 20px;\n        height: 20px; \n        x: 0; \n        y: 0;\n        rx: 5px;\n        ry: 5px;\n    }\n    .topic-task-marker-item[d-task-marker-selected] > rect {\n        fill: var(--topic-ui-focus-color);\n        stroke: var(--topic-ui-focus-border-color);\n        stroke-width: 1px;\n        stroke-dasharray: 2;\n    }\n    .topic-task-marker-placeholder {\n        fill: none;\n        stroke: none;\n        width: 20px;\n        height: 20px; \n        x: 0; \n        y: 0;\n        rx: 5px;\n        ry: 5px;\n    }\n</style>\n<g mmap-layout="line">\n    <g class="topic-task-marker-item season-topic-svg-button" mmap-event-click="selectTaskMarker" d-task-marker-value="0">\n        <rect />\n        <use href="#topic-task-marker-0" />\n    </g>\n    <g class="topic-task-marker-item season-topic-svg-button" mmap-event-click="selectTaskMarker" d-task-marker-value="1">\n        <rect />\n        <use href="#topic-task-marker-1" />\n    </g>\n    <g class="topic-task-marker-item season-topic-svg-button" mmap-event-click="selectTaskMarker" d-task-marker-value="2">\n        <rect />\n        <use href="#topic-task-marker-2" />\n    </g>\n    <g class="topic-task-marker-item season-topic-svg-button" mmap-event-click="selectTaskMarker" d-task-marker-value="3">\n        <rect />\n        <use href="#topic-task-marker-3" />\n    </g>\n</g>\n<g mmap-layout="line">\n    <g class="topic-task-marker-item season-topic-svg-button" mmap-event-click="selectTaskMarker" d-task-marker-value="4">\n        <rect />\n        <use href="#topic-task-marker-4" />\n    </g>\n    <g class="topic-task-marker-item season-topic-svg-button" mmap-event-click="selectTaskMarker" d-task-marker-value="5">\n        <rect />\n        <use href="#topic-task-marker-5" />\n    </g>\n    <g class="topic-task-marker-item season-topic-svg-button" mmap-event-click="selectTaskMarker" d-task-marker-value="6">\n        <rect />\n        <use href="#topic-task-marker-6" />\n    </g>\n    <g class="topic-task-marker-item season-topic-svg-button" mmap-event-click="selectTaskMarker" d-task-marker-value="7">\n        <rect />\n        <use href="#topic-task-marker-7" />\n    </g>\n</g>\n<g mmap-layout="line">\n    <g class="topic-task-marker-item season-topic-svg-button" mmap-event-click="selectTaskMarker" d-task-marker-value="8">\n        <rect />\n        <use href="#topic-task-marker-8" />\n    </g>\n    <g class="topic-task-marker-item season-topic-svg-button" mmap-event-click="selectTaskMarker" d-task-marker-value="unknown">\n        <rect />\n        <use href="#topic-task-marker-unknown" />\n    </g>\n    <rect class="topic-task-marker-placeholder" />\n    <g class="topic-task-marker-item season-topic-svg-button" d-svg-button-danger="" mmap-event-click="deleteTaskMarker">\n        <rect />\n        <use href="#season-topic-predefine-image-delete" width="20" height="20" />\n    </g>\n</g>\n',Object.assign({topic:t,env:t.env,singletonMutex:t.id},Xt))}},labels:{edit:function(e){var t=e.eventTarget;t instanceof Ne&&wt(t.$assignedNode.ownerSVGElement,'\n<style>\n    .season-topic-label-edit-item {\n        font-size: 12px;\n    }\n    .season-topic-label-edit-item > text {\n        alignment-baseline: before-edge;\n        dominant-baseline: text-before-edge;\n        fill: #666;\n    }\n    .season-topic-label-edit-item > rect {\n        fill: none;\n        stroke-width: 0.5px;\n        stroke: #666;\n        stroke-dasharray: 2;\n    }\n    .season-topic-label-edit-delete > rect {\n        fill: #ddd;\n        stroke: none;\n    }\n    .season-topic-label-edit-delete > use {\n        fill: #fff;\n        stroke: none;\n    }\n    .season-topic-label-edit-delete:hover > rect {\n        fill: var(--topic-ui-danger-color);\n        stroke: none;\n    }\n</style>\n<g mmap-layout="line" mmap-layout-max-width="120" mmap-layout-margin="5" mmap-layout-padding="0" class="season-topic-labels-edit-list">\n\n</g>\n<foreignObject width="120" height="26">\n    <style>\n        .season-topic-label-edit-input {\n            width: 100%;\n            height: 100%;\n            outline: none;\n            border: 1px solid #ccc;\n            box-sizing: border-box;\n            font-size: 12px;\n        }\n    </style>\n    <input class="season-topic-label-edit-input" placeholder="new label..." mmap-event-keydown="onInputKeydown" />\n</foreignObject>\n',Object.assign({topic:t,env:t.env,singletonMutex:t.id},Tt))}},notes:{edit:Wt,trigger:Wt}};e.CreateTopicExtensionFactor=ht,e.DefaultTopicEventActions=Kt,e.DefaultTopicExtensions=ft,e.EBlockFactor=l,e.MindmapContainer=ee,e.MindmapDocument=We,e.MindmapEnvironment=X,e.MindmapViewer=dt,e.Topic=Ne,e.TopicExtension=j,e.TopicExtensionFactor=H,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=index.js.map
